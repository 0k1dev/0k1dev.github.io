<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng Qu·∫£n L√Ω Kh√°ch S·∫°n & Nh√† H√†ng Cao C·∫•p</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè®</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        h1 {
            text-align: center;
            font-size: 2.8em;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .hotel-info {
            text-align: center;
            color: #666;
            font-size: 1.1em;
            margin-top: 10px;
        }

        .view-toggle {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .view-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .view-btn.active {
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .view-btn:not(.active) {
            background: #e9ecef;
            color: #666;
        }

        .view-btn:not(.active):hover {
            background: #dee2e6;
        }

        .view-content {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .view-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Customer View */
        .customer-view {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .customer-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 1200px) {
            .customer-info {
                grid-template-columns: 1fr;
            }
        }

        .room-select, .customer-details {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border: 1px solid #e9ecef;
        }

        .room-select label, .customer-details label {
            display: block;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .room-select select, .customer-details input, .customer-details select {
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            margin-bottom: 15px;
            transition: border 0.3s;
        }

        .room-select select:focus, .customer-details input:focus, .customer-details select:focus {
            border-color: #3498db;
            outline: none;
        }

        .room-price-display {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-top: 15px;
            font-weight: bold;
            font-size: 1.2em;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .menu-section {
            margin-bottom: 30px;
        }

        .menu-section h2 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .menu-item {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .menu-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-color: #3498db;
        }

        .menu-item.highlight {
            background: linear-gradient(135deg, #fff9db 0%, #ffec99 100%);
            border-color: #ffd43b;
        }

        .menu-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .menu-name {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 1.2em;
        }

        .menu-category {
            font-size: 0.8em;
            background: #e9ecef;
            padding: 3px 10px;
            border-radius: 10px;
            display: inline-block;
            margin-bottom: 10px;
        }

        .menu-price {
            color: #e74c3c;
            font-weight: bold;
            font-size: 1.3em;
        }

        .order-summary {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            border: 1px solid #e9ecef;
        }

        .order-summary h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .order-items {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            min-height: 150px;
            border: 1px solid #dee2e6;
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f1f1f1;
        }

        .order-item:last-child {
            border-bottom: none;
        }

        .item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .item-qty {
            font-weight: bold;
            min-width: 30px;
            text-align: center;
        }

        .qty-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            background: #3498db;
            color: white;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-btn {
            background: #e74c3c;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .order-total {
            display: flex;
            justify-content: space-between;
            font-size: 1.5em;
            font-weight: bold;
            padding-top: 15px;
            border-top: 2px solid #dee2e6;
            color: #2c3e50;
        }

        .order-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .order-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }

        .order-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Staff View */
        .staff-view {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 1400px) {
            .staff-view {
                grid-template-columns: 1fr;
            }
        }

        .orders-panel, .rooms-panel, .dashboard-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .dashboard-panel {
            grid-column: 1 / -1;
        }

        .orders-panel h2, .rooms-panel h2, .dashboard-panel h2 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 20px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .order-card {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .order-card.high-priority {
            border-color: #e74c3c;
            background: #fff5f5;
        }

        .order-card.medium-priority {
            border-color: #f39c12;
            background: #fff9e6;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f1f1f1;
        }

        .order-room {
            font-size: 1.3em;
            font-weight: bold;
            color: #3498db;
        }

        .order-time {
            font-size: 0.9em;
            color: #666;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .order-priority {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .priority-high {
            background: #e74c3c;
            color: white;
        }

        .priority-medium {
            background: #f39c12;
            color: white;
        }

        .priority-low {
            background: #27ae60;
            color: white;
        }

        .order-items {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            white-space: pre-wrap;
            line-height: 1.6;
        }

        .order-actions {
            display: flex;
            gap: 10px;
        }

        .complete-btn, .cancel-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .complete-btn {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
        }

        .cancel-btn {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        .rooms-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .floor-select {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .floor-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: 2px solid #ddd;
            background: white;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .floor-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .rooms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .room-card {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s;
            position: relative;
        }

        .room-card.vip {
            border-color: #f1c40f;
            background: linear-gradient(135deg, #fff9db 0%, #ffec99 100%);
        }

        .room-card.suite {
            border-color: #9b59b6;
            background: linear-gradient(135deg, #f5eef8 0%, #e8daef 100%);
        }

        .room-card.occupied {
            border-color: #27ae60;
        }

        .room-card.need-cleaning {
            border-color: #e74c3c;
        }

        .room-header-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .room-number {
            font-size: 1.3em;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .room-type {
            font-size: 0.8em;
            padding: 3px 10px;
            border-radius: 10px;
            font-weight: bold;
        }

        .type-standard {
            background: #3498db;
            color: white;
        }

        .type-vip {
            background: #f1c40f;
            color: white;
        }

        .type-suite {
            background: #9b59b6;
            color: white;
        }

        .room-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-occupied {
            background: #27ae60;
            color: white;
        }

        .status-empty {
            background: #95a5a6;
            color: white;
        }

        .status-cleaning {
            background: #e74c3c;
            color: white;
        }

        .room-customer {
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .room-details {
            color: #666;
            margin-bottom: 8px;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .room-price {
            font-weight: bold;
            color: #e74c3c;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .room-actions {
            display: flex;
            gap: 10px;
        }

        .room-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-size: 0.9em;
        }

        .checkin-btn {
            background: #3498db;
            color: white;
        }

        .checkout-btn {
            background: #e74c3c;
            color: white;
        }

        .cleaning-btn {
            background: #f39c12;
            color: white;
        }

        .service-btn {
            background: #9b59b6;
            color: white;
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.1);
            z-index: 1;
        }

        .stat-card.revenue {
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
        }

        .stat-card.occupancy {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }

        .stat-card.rooms {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
        }

        .stat-card.orders {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .stat-card > * {
            position: relative;
            z-index: 2;
        }

        .stat-label {
            font-size: 1em;
            margin-bottom: 10px;
            opacity: 0.9;
            font-weight: 600;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-change {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .positive-change {
            color: #2ecc71;
        }

        .negative-change {
            color: #e74c3c;
        }

        .recent-activity {
            background: white;
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }

        .activity-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .activity-item {
            padding: 15px 0;
            border-bottom: 1px solid #f1f1f1;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            color: white;
        }

        .icon-checkin {
            background: #3498db;
        }

        .icon-checkout {
            background: #e74c3c;
        }

        .icon-order {
            background: #27ae60;
        }

        .icon-cleaning {
            background: #f39c12;
        }

        .activity-details {
            flex: 1;
        }

        .activity-time {
            font-size: 0.8em;
            color: #95a5a6;
        }

        .notifications {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            max-width: 400px;
        }

        .notification {
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            animation: slideIn 0.3s ease-out;
            border-left: 5px solid #3498db;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.success {
            border-left-color: #27ae60;
        }

        .notification.warning {
            border-left-color: #f39c12;
        }

        .notification.error {
            border-left-color: #e74c3c;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-content h3 {
            margin-bottom: 25px;
            color: #2c3e50;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border 0.3s;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: #3498db;
            outline: none;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .modal-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .modal-btn.confirm {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
        }

        .modal-btn.confirm:hover {
            background: linear-gradient(135deg, #219653 0%, #27ae60 100%);
        }

        .modal-btn.cancel {
            background: #95a5a6;
            color: white;
        }

        .modal-btn.cancel:hover {
            background: #7f8c8d;
        }

        .room-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.7em;
            font-weight: bold;
            color: white;
        }

        .badge-new {
            background: #e74c3c;
        }

        .badge-promo {
            background: #9b59b6;
        }

        .badge-sea-view {
            background: #3498db;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #95a5a6;
        }

        .empty-state i {
            font-size: 3em;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .highlight-room {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(52, 152, 219, 0); }
            100% { box-shadow: 0 0 0 0 rgba(52, 152, 219, 0); }
        }

        /* Service Request Styles */
        .service-request {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px dashed #ddd;
        }

        .service-tag {
            display: inline-block;
            background: #e8f4fc;
            color: #3498db;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8em;
            margin-right: 5px;
            margin-bottom: 5px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .customer-view, .orders-panel, .rooms-panel, .dashboard-panel {
                padding: 20px;
            }
            
            .view-btn {
                padding: 10px 20px;
                font-size: 0.9em;
            }
            
            .menu-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .rooms-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .dashboard-stats {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
            
            .stat-value {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <!-- TH√äM PH·∫¶N N√ÄY V√ÄO SAU PH·∫¶N managementView HI·ªÜN C√ì -->

<!-- Reports Management Section -->
<div class="management-tab" id="reportsTab">
    <div class="management-view">
        <h2 style="margin-bottom: 30px; display: flex; align-items: center; gap: 15px;">
            <i class="fas fa-file-alt"></i> H·ªá Th·ªëng B√°o C√°o Chi Ti·∫øt
        </h2>
        
        <!-- Report Generation Controls -->
        <div style="background: white; border-radius: 15px; padding: 25px; margin-bottom: 30px; border: 1px solid #e9ecef; box-shadow: 0 4px 6px rgba(0,0,0,0.05);">
            <h3 style="margin-bottom: 20px; color: #2c3e50;"><i class="fas fa-cog"></i> T√πy Ch·ªçn B√°o C√°o</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 25px;">
                <div class="form-group">
                    <label><i class="far fa-calendar"></i> Lo·∫°i B√°o C√°o</label>
                    <select id="reportTypeSelect" class="report-control">
                        <option value="financial">B√°o C√°o T√†i Ch√≠nh</option>
                        <option value="occupancy">B√°o C√°o Ph√≤ng ·ªêc</option>
                        <option value="customer">B√°o C√°o Kh√°ch H√†ng</option>
                        <option value="service">B√°o C√°o D·ªãch V·ª•</option>
                        <option value="staff">B√°o C√°o Nh√¢n S·ª±</option>
                        <option value="inventory">B√°o C√°o T·ªìn Kho</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label><i class="far fa-clock"></i> K·ª≥ B√°o C√°o</label>
                    <select id="reportPeriodSelect" class="report-control">
                        <option value="daily">H√†ng Ng√†y</option>
                        <option value="weekly">H√†ng Tu·∫ßn</option>
                        <option value="monthly" selected>H√†ng Th√°ng</option>
                        <option value="quarterly">H√†ng Qu√Ω</option>
                        <option value="yearly">H√†ng NƒÉm</option>
                        <option value="custom">T√πy Ch·ªânh</option>
                    </select>
                </div>
                
                <div class="form-group" id="customDateRange" style="display: none;">
                    <label><i class="far fa-calendar-alt"></i> Kho·∫£ng Th·ªùi Gian</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="date" id="startDate" style="flex: 1;">
                        <input type="date" id="endDate" style="flex: 1;">
                    </div>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-filter"></i> B·ªô L·ªçc</label>
                    <select id="reportFilterSelect" class="report-control">
                        <option value="all">T·∫•t C·∫£</option>
                        <option value="vip">Ch·ªâ VIP</option>
                        <option value="standard">Ch·ªâ Standard</option>
                        <option value="suite">Ch·ªâ Suite</option>
                        <option value="floor1-3">T·∫ßng 1-3</option>
                        <option value="floor4-7">T·∫ßng 4-7</option>
                    </select>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button class="order-btn" onclick="generateReport()" style="width: auto; padding: 12px 30px;">
                    <i class="fas fa-chart-bar"></i> T·∫°o B√°o C√°o
                </button>
                <button class="order-btn" onclick="exportReportToExcel()" style="width: auto; padding: 12px 30px; background: #27ae60;">
                    <i class="fas fa-file-excel"></i> Xu·∫•t Excel
                </button>
                <button class="order-btn" onclick="printReport()" style="width: auto; padding: 12px 30px; background: #3498db;">
                    <i class="fas fa-print"></i> In B√°o C√°o
                </button>
                <button class="order-btn" onclick="saveReportTemplate()" style="width: auto; padding: 12px 30px; background: #9b59b6;">
                    <i class="fas fa-save"></i> L∆∞u M·∫´u
                </button>
            </div>
        </div>
        
        <!-- Report Display Area -->
        <div id="reportDisplayArea" style="display: none;">
            <!-- Report will be dynamically generated here -->
        </div>
        
        <!-- Report Templates Gallery -->
        <div style="background: white; border-radius: 15px; padding: 25px; margin-top: 30px; border: 1px solid #e9ecef;">
            <h3 style="margin-bottom: 20px; color: #2c3e50;"><i class="fas fa-th"></i> M·∫´u B√°o C√°o C√≥ S·∫µn</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <div class="report-template" onclick="loadReportTemplate('daily_summary')">
                    <div style="background: linear-gradient(135deg, #3498db, #2c3e50); color: white; padding: 20px; border-radius: 10px 10px 0 0;">
                        <i class="fas fa-sun" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4 style="margin: 0;">B√°o C√°o Ng√†y</h4>
                    </div>
                    <div style="padding: 15px; background: #f8f9fa; border-radius: 0 0 10px 10px;">
                        <p style="color: #666; font-size: 0.9em;">T√≥m t·∫Øt ho·∫°t ƒë·ªông trong ng√†y, doanh thu, ƒë∆°n h√†ng</p>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span style="font-size: 0.8em; color: #3498db;"><i class="far fa-clock"></i> H√†ng ng√†y</span>
                            <button class="modal-btn confirm" style="padding: 5px 15px; font-size: 0.8em;">S·ª≠ d·ª•ng</button>
                        </div>
                    </div>
                </div>
                
                <div class="report-template" onclick="loadReportTemplate('monthly_financial')">
                    <div style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; padding: 20px; border-radius: 10px 10px 0 0;">
                        <i class="fas fa-chart-line" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4 style="margin: 0;">B√°o C√°o T√†i Ch√≠nh Th√°ng</h4>
                    </div>
                    <div style="padding: 15px; background: #f8f9fa; border-radius: 0 0 10px 10px;">
                        <p style="color: #666; font-size: 0.9em;">Doanh thu, chi ph√≠, l·ª£i nhu·∫≠n, ph√¢n t√≠ch xu h∆∞·ªõng</p>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span style="font-size: 0.8em; color: #27ae60;"><i class="far fa-calendar"></i> H√†ng th√°ng</span>
                            <button class="modal-btn confirm" style="padding: 5px 15px; font-size: 0.8em;">S·ª≠ d·ª•ng</button>
                        </div>
                    </div>
                </div>
                
                <div class="report-template" onclick="loadReportTemplate('customer_analysis')">
                    <div style="background: linear-gradient(135deg, #9b59b6, #8e44ad); color: white; padding: 20px; border-radius: 10px 10px 0 0;">
                        <i class="fas fa-users" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4 style="margin: 0;">Ph√¢n T√≠ch Kh√°ch H√†ng</h4>
                    </div>
                    <div style="padding: 15px; background: #f8f9fa; border-radius: 0 0 10px 10px;">
                        <p style="color: #666; font-size: 0.9em;">H√†nh vi, th√≥i quen, ph√¢n kh√∫c kh√°ch h√†ng VIP</p>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span style="font-size: 0.8em; color: #9b59b6;"><i class="fas fa-chart-pie"></i> Ph√¢n t√≠ch</span>
                            <button class="modal-btn confirm" style="padding: 5px 15px; font-size: 0.8em;">S·ª≠ d·ª•ng</button>
                        </div>
                    </div>
                </div>
                
                <div class="report-template" onclick="loadReportTemplate('room_performance')">
                    <div style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; padding: 20px; border-radius: 10px 10px 0 0;">
                        <i class="fas fa-bed" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4 style="margin: 0;">Hi·ªáu Su·∫•t Ph√≤ng</h4>
                    </div>
                    <div style="padding: 15px; background: #f8f9fa; border-radius: 0 0 10px 10px;">
                        <p style="color: #666; font-size: 0.9em;">T·ª∑ l·ªá l·∫•p ƒë·∫ßy, doanh thu ph√≤ng, ph·ªï bi·∫øn nh·∫•t</p>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span style="font-size: 0.8em; color: #e74c3c;"><i class="fas fa-star"></i> Hi·ªáu su·∫•t</span>
                            <button class="modal-btn confirm" style="padding: 5px 15px; font-size: 0.8em;">S·ª≠ d·ª•ng</button>
                        </div>
                    </div>
                </div>
                
                <div class="report-template" onclick="loadReportTemplate('staff_performance')">
                    <div style="background: linear-gradient(135deg, #f39c12, #e67e22); color: white; padding: 20px; border-radius: 10px 10px 0 0;">
                        <i class="fas fa-user-tie" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4 style="margin: 0;">Hi·ªáu Su·∫•t Nh√¢n Vi√™n</h4>
                    </div>
                    <div style="padding: 15px; background: #f8f9fa; border-radius: 0 0 10px 10px;">
                        <p style="color: #666; font-size: 0.9em;">NƒÉng su·∫•t, ƒë√°nh gi√°, ch·∫•m c√¥ng, hoa h·ªìng</p>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span style="font-size: 0.8em; color: #f39c12;"><i class="fas fa-chart-bar"></i> KPI</span>
                            <button class="modal-btn confirm" style="padding: 5px 15px; font-size: 0.8em;">S·ª≠ d·ª•ng</button>
                        </div>
                    </div>
                </div>
                
                <div class="report-template" onclick="loadReportTemplate('inventory_report')">
                    <div style="background: linear-gradient(135deg, #1abc9c, #16a085); color: white; padding: 20px; border-radius: 10px 10px 0 0;">
                        <i class="fas fa-boxes" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4 style="margin: 0;">B√°o C√°o T·ªìn Kho</h4>
                    </div>
                    <div style="padding: 15px; background: #f8f9fa; border-radius: 0 0 10px 10px;">
                        <p style="color: #666; font-size: 0.9em;">T·ªìn kho, v·∫≠t t∆∞, ƒë·∫∑t h√†ng, c·∫£nh b√°o h·∫øt h√†ng</p>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span style="font-size: 0.8em; color: #1abc9c;"><i class="fas fa-warehouse"></i> Kho</span>
                            <button class="modal-btn confirm" style="padding: 5px 15px; font-size: 0.8em;">S·ª≠ d·ª•ng</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Historical Reports -->
        <div style="background: white; border-radius: 15px; padding: 25px; margin-top: 30px; border: 1px solid #e9ecef;">
            <h3 style="margin-bottom: 20px; color: #2c3e50;"><i class="fas fa-history"></i> B√°o C√°o ƒê√£ L∆∞u</h3>
            
            <div style="overflow-x: auto;">
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>T√™n B√°o C√°o</th>
                            <th>Lo·∫°i</th>
                            <th>K·ª≥</th>
                            <th>Ng√†y T·∫°o</th>
                            <th>K√≠ch Th∆∞·ªõc</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="savedReportsList">
                        <!-- Saved reports will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Report Preview Modal -->
<div class="modal" id="reportPreviewModal">
    <div class="modal-content" style="max-width: 90%; max-height: 90vh;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h3 id="reportPreviewTitle"><i class="fas fa-file-pdf"></i> Xem Tr∆∞·ªõc B√°o C√°o</h3>
            <button onclick="closeModal()" style="background: none; border: none; font-size: 1.5em; color: #666; cursor: pointer;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div id="reportPreviewContent" style="max-height: 70vh; overflow-y: auto; padding: 20px; background: #f8f9fa; border-radius: 10px;">
            <!-- Report preview will be loaded here -->
        </div>
        
        <div style="display: flex; gap: 15px; margin-top: 20px; justify-content: center;">
            <button class="modal-btn confirm" onclick="downloadReport()">
                <i class="fas fa-download"></i> T·∫£i PDF
            </button>
            <button class="modal-btn confirm" style="background: #27ae60;" onclick="printReportPreview()">
                <i class="fas fa-print"></i> In B√°o C√°o
            </button>
            <button class="modal-btn cancel" onclick="closeModal()">
                <i class="fas fa-times"></i> ƒê√≥ng
            </button>
        </div>
    </div>
</div>

<!-- Th√™m CSS cho ph·∫ßn b√°o c√°o -->
<style>
    .report-template {
        background: white;
        border-radius: 10px;
        overflow: hidden;
        cursor: pointer;
        transition: all 0.3s;
        border: 2px solid transparent;
    }
    
    .report-template:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        border-color: #3498db;
    }
    
    .report-control {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 1em;
        transition: border 0.3s;
    }
    
    .report-control:focus {
        border-color: #3498db;
        outline: none;
    }
    
    .report-section {
        background: white;
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 25px;
        border: 1px solid #e9ecef;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }
    
    .report-header {
        background: linear-gradient(135deg, #3498db, #2c3e50);
        color: white;
        padding: 20px;
        border-radius: 10px 10px 0 0;
        margin-bottom: 20px;
    }
    
    .report-stat {
        text-align: center;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 10px;
        margin-bottom: 15px;
    }
    
    .report-stat .value {
        font-size: 2.5em;
        font-weight: bold;
        margin: 10px 0;
    }
    
    .report-stat .label {
        color: #666;
        font-size: 0.9em;
    }
    
    .report-chart {
        height: 300px;
        display: flex;
        align-items: flex-end;
        gap: 10px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 10px;
        margin: 20px 0;
    }
    
    .comparison-badge {
        display: inline-block;
        padding: 3px 10px;
        border-radius: 15px;
        font-size: 0.8em;
        font-weight: bold;
        margin-left: 10px;
    }
    
    .comparison-positive {
        background: #d4edda;
        color: #155724;
    }
    
    .comparison-negative {
        background: #f8d7da;
        color: #721c24;
    }
    
    .comparison-neutral {
        background: #fff3cd;
        color: #856404;
    }
    
    .insight-card {
        background: #e8f4fc;
        border-left: 4px solid #3498db;
        padding: 15px;
        margin: 15px 0;
        border-radius: 0 8px 8px 0;
    }
    
    .insight-card.warning {
        background: #fff3cd;
        border-left-color: #f39c12;
    }
    
    .insight-card.success {
        background: #d4edda;
        border-left-color: #27ae60;
    }
    
    .insight-card.danger {
        background: #f8d7da;
        border-left-color: #e74c3c;
    }
</style>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-hotel"></i> Kh√°ch S·∫°n & Nh√† H√†ng Cao C·∫•p Horizon</h1>
            <div class="hotel-info">7 t·∫ßng ‚Ä¢ 70 ph√≤ng ‚Ä¢ D·ªãch v·ª• 5 sao</div>
            <div class="view-toggle">
                <button class="view-btn active" onclick="switchView('customer')">
                    <i class="fas fa-user"></i> Kh√°ch H√†ng
                </button>
                <button class="view-btn" onclick="switchView('staff')">
                    <i class="fas fa-user-tie"></i> Nh√¢n Vi√™n
                </button>
                <button class="view-btn" onclick="switchView('management')">
                    <i class="fas fa-chart-line"></i> Qu·∫£n L√Ω
                </button>
            </div>
        </div>

        <!-- Notifications -->
        <div class="notifications" id="notifications"></div>

        <!-- Customer View -->
        <div class="view-content active" id="customerView">
            <div class="customer-view">
                <div class="customer-info">
                    <div class="room-select">
                        <label><i class="fas fa-door-open"></i> Ch·ªçn Ph√≤ng & Lo·∫°i Ph√≤ng</label>
                        <select id="customerRoom" onchange="updateRoomDetails()">
                            <option value="">-- Ch·ªçn ph√≤ng --</option>
                        </select>
                        
                        <select id="roomTypeFilter" onchange="filterRoomsByType()">
                            <option value="all">T·∫•t c·∫£ lo·∫°i ph√≤ng</option>
                            <option value="standard">Ph√≤ng Ti√™u Chu·∫©n</option>
                            <option value="vip">Ph√≤ng VIP</option>
                            <option value="suite">Suite</option>
                        </select>
                        
                        <div id="roomDetails" class="room-price-display" style="display:none;">
                            <div id="roomTypeDisplay"></div>
                            <div id="roomPriceDisplay"></div>
                            <div id="roomFeatures"></div>
                        </div>
                    </div>

                    <div class="customer-details">
                        <label><i class="fas fa-user-circle"></i> Th√¥ng Tin Kh√°ch H√†ng</label>
                        <input type="text" id="customerName" placeholder="H·ªç v√† t√™n">
                        <input type="text" id="customerPhone" placeholder="S·ªë ƒëi·ªán tho·∫°i">
                        <input type="email" id="customerEmail" placeholder="Email">
                        <select id="customerGender">
                            <option value="">Gi·ªõi t√≠nh</option>
                            <option value="male">Nam</option>
                            <option value="female">N·ªØ</option>
                            <option value="other">Kh√°c</option>
                        </select>
                    </div>
                </div>

                <div class="menu-section">
                    <h2><i class="fas fa-utensils"></i> Th·ª±c ƒê∆°n Nh√† H√†ng - Nh·∫•n ƒë·ªÉ th√™m v√†o ƒë∆°n</h2>
                    
                    <div class="filter-controls">
                        <button class="filter-btn active" onclick="filterMenu('all')">T·∫•t c·∫£</button>
                        <button class="filter-btn" onclick="filterMenu('appetizer')">Khai v·ªã</button>
                        <button class="filter-btn" onclick="filterMenu('main')">M√≥n ch√≠nh</button>
                        <button class="filter-btn" onclick="filterMenu('drink')">ƒê·ªì u·ªëng</button>
                        <button class="filter-btn" onclick="filterMenu('dessert')">Tr√°ng mi·ªáng</button>
                    </div>
                    
                    <div class="menu-grid" id="menuGrid"></div>
                </div>

                <div class="order-summary">
                    <h3><i class="fas fa-shopping-cart"></i> ƒê∆°n H√†ng C·ªßa B·∫°n</h3>
                    <div class="order-items" id="orderItems">
                        <div class="empty-state">
                            <i class="fas fa-shopping-basket"></i>
                            <p>Ch∆∞a c√≥ m√≥n n√†o trong ƒë∆°n h√†ng</p>
                            <p>H√£y ch·ªçn m√≥n t·ª´ th·ª±c ƒë∆°n b√™n tr√™n</p>
                        </div>
                    </div>
                    
                    <div class="order-total">
                        <span>T·ªïng c·ªông:</span>
                        <span id="orderTotal">0ƒë</span>
                    </div>
                    
                    <button class="order-btn" id="submitOrderBtn" onclick="submitOrder()" disabled>
                        <i class="fas fa-paper-plane"></i> G·ª≠i ƒê∆°n H√†ng
                    </button>
                </div>
            </div>
        </div>

        <!-- Staff View -->
        <div class="view-content" id="staffView">
            <div class="staff-view">
                <!-- Orders Panel -->
                <div class="orders-panel">
                    <h2><i class="fas fa-concierge-bell"></i> ƒê∆°n ƒê·∫∑t D·ªãch V·ª•</h2>
                    
                    <div class="filter-controls">
                        <button class="filter-btn active" onclick="filterOrders('all')">T·∫•t c·∫£</button>
                        <button class="filter-btn" onclick="filterOrders('pending')">Ch·ªù x·ª≠ l√Ω</button>
                        <button class="filter-btn" onclick="filterOrders('preparing')">ƒêang chu·∫©n b·ªã</button>
                        <button class="filter-btn" onclick="filterOrders('completed')">Ho√†n th√†nh</button>
                        <button class="filter-btn" onclick="filterOrders('cancelled')">ƒê√£ h·ªßy</button>
                    </div>
                    
                    <div id="ordersList"></div>
                </div>

                <!-- Rooms Panel -->
                <div class="rooms-panel">
                    <div class="rooms-navigation">
                        <h2><i class="fas fa-bed"></i> Qu·∫£n L√Ω Ph√≤ng</h2>
                        <div class="floor-select">
                            <button class="floor-btn active" onclick="changeFloor('all')">T·∫•t c·∫£</button>
                            <!-- Floor buttons will be generated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="rooms-grid" id="roomsList"></div>
                </div>
                
                <!-- Dashboard Panel -->
                <div class="dashboard-panel">
                    <h2><i class="fas fa-tachometer-alt"></i> Th·ªëng K√™ Nhanh</h2>
                    
                    <div class="dashboard-stats">
                        <div class="stat-card revenue">
                            <div class="stat-label">Doanh Thu H√¥m Nay</div>
                            <div class="stat-value" id="todayRevenue">0ƒë</div>
                            <div class="stat-change positive-change">+12% so v·ªõi h√¥m qua</div>
                        </div>
                        <div class="stat-card occupancy">
                            <div class="stat-label">T·ª∑ L·ªá Thu√™ Ph√≤ng</div>
                            <div class="stat-value" id="occupancyRate">0%</div>
                            <div class="stat-change positive-change">+5% so v·ªõi tu·∫ßn tr∆∞·ªõc</div>
                        </div>
                        <div class="stat-card rooms">
                            <div class="stat-label">Ph√≤ng Tr·ªëng</div>
                            <div class="stat-value" id="availableRooms">70</div>
                            <div class="stat-change negative-change">-8 so v·ªõi h√¥m qua</div>
                        </div>
                        <div class="stat-card orders">
                            <div class="stat-label">ƒê∆°n H√†ng H√¥m Nay</div>
                            <div class="stat-value" id="todayOrders">0</div>
                            <div class="stat-change positive-change">+3 so v·ªõi h√¥m qua</div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 30px; margin-bottom: 15px;"><i class="fas fa-history"></i> Ho·∫°t ƒê·ªông G·∫ßn ƒê√¢y</h3>
                    <div class="recent-activity">
                        <div class="activity-list" id="activityList"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Management View -->
        <div class="view-content" id="managementView">
            <div class="customer-view">
                <h2 style="margin-bottom: 30px;"><i class="fas fa-chart-line"></i> B√°o C√°o Qu·∫£n L√Ω</h2>
                <div style="text-align: center; padding: 60px 20px; color: #7f8c8d;">
                    <i class="fas fa-chart-bar" style="font-size: 4em; margin-bottom: 20px;"></i>
                    <h3>Ch·ª©c nƒÉng b√°o c√°o chi ti·∫øt ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn</h3>
                    <p>Bao g·ªìm: B√°o c√°o doanh thu, t·ª∑ l·ªá l·∫•p ƒë·∫ßy ph√≤ng, ph√¢n t√≠ch kh√°ch h√†ng, v.v.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="checkinModal">
        <div class="modal-content">
            <h3><i class="fas fa-key"></i> Nh·∫≠n Ph√≤ng</h3>
            <div class="form-group">
                <label for="modalCustomerName">T√™n kh√°ch h√†ng</label>
                <input type="text" id="modalCustomerName" placeholder="H·ªç v√† t√™n">
            </div>
            <div class="form-group">
                <label for="modalCustomerPhone">S·ªë ƒëi·ªán tho·∫°i</label>
                <input type="text" id="modalCustomerPhone" placeholder="S·ªë ƒëi·ªán tho·∫°i">
            </div>
            <div class="form-group">
                <label for="modalNumDays">S·ªë ng√†y thu√™</label>
                <input type="number" id="modalNumDays" placeholder="S·ªë ng√†y thu√™" min="1" value="1">
            </div>
            <div class="form-group">
                <label for="modalSpecialRequests">Y√™u c·∫ßu ƒë·∫∑c bi·ªát</label>
                <textarea id="modalSpecialRequests" placeholder="V√≠ d·ª•: Th√™m gi∆∞·ªùng, th·ª©c ƒÉn ƒë·∫∑c bi·ªát, v.v." rows="3"></textarea>
            </div>
            <div class="modal-actions">
                <button class="modal-btn confirm" onclick="confirmCheckin()">
                    <i class="fas fa-check"></i> X√°c Nh·∫≠n
                </button>
                <button class="modal-btn cancel" onclick="closeModal()">
                    <i class="fas fa-times"></i> H·ªßy
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="serviceModal">
        <div class="modal-content">
            <h3><i class="fas fa-concierge-bell"></i> Y√™u C·∫ßu D·ªãch V·ª• Ph√≤ng</h3>
            <div class="form-group">
                <label>Ph√≤ng: <span id="serviceRoomNumber" style="font-weight: bold;"></span></label>
            </div>
            <div class="form-group">
                <label>Ch·ªçn d·ªãch v·ª•:</label>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" class="service-checkbox" value="d·ªçn ph√≤ng">
                        <span>D·ªçn ph√≤ng</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" class="service-checkbox" value="thay khƒÉn">
                        <span>Thay khƒÉn</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" class="service-checkbox" value="th√™m ƒë·ªì d√πng">
                        <span>Th√™m ƒë·ªì d√πng</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" class="service-checkbox" value="ƒë√°nh th·ª©c">
                        <span>ƒê√°nh th·ª©c</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" class="service-checkbox" value="gi·∫∑t ·ªßi">
                        <span>Gi·∫∑t ·ªßi</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" class="service-checkbox" value="ƒë∆∞a ƒë√≥n">
                        <span>ƒê∆∞a ƒë√≥n</span>
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label for="serviceNotes">Ghi ch√∫ th√™m</label>
                <textarea id="serviceNotes" placeholder="Ghi ch√∫ th√™m cho d·ªãch v·ª•..." rows="3"></textarea>
            </div>
            <div class="modal-actions">
                <button class="modal-btn confirm" onclick="confirmServiceRequest()">
                    <i class="fas fa-paper-plane"></i> G·ª≠i Y√™u C·∫ßu
                </button>
                <button class="modal-btn cancel" onclick="closeModal()">
                    <i class="fas fa-times"></i> H·ªßy
                </button>
            </div>
        </div>
    </div>

    <script>
        // Enhanced data structures
        const MENU_ITEMS = [
            { id: 'goi-cuon', name: 'G·ªèi cu·ªën', price: 45000, icon: 'ü•¨', category: 'appetizer', description: 'G·ªèi cu·ªën t√¥m th·ªãt' },
            { id: 'sup-ngo', name: 'S√∫p n·∫•m', price: 35000, icon: 'üç≤', category: 'appetizer', description: 'S√∫p n·∫•m t∆∞∆°i' },
            { id: 'com-ga', name: 'C∆°m g√†', price: 75000, icon: 'üçö', category: 'main', description: 'C∆°m g√† x·ªëi m·ª°' },
            { id: 'pho-bo', name: 'Ph·ªü b√≤', price: 65000, icon: 'üçú', category: 'main', description: 'Ph·ªü b√≤ H√† N·ªôi' },
            { id: 'bun-cha', name: 'B√∫n ch·∫£', price: 70000, icon: 'üçù', category: 'main', description: 'B√∫n ch·∫£ H√† N·ªôi' },
            { id: 'ca-kho', name: 'C√° kho', price: 85000, icon: 'üêü', category: 'main', description: 'C√° kho t·ªô' },
            { id: 'nuoc-cam', name: 'N∆∞·ªõc cam', price: 35000, icon: 'üçä', category: 'drink', description: 'N∆∞·ªõc cam √©p' },
            { id: 'cafe', name: 'Caf√© s·ªØa', price: 25000, icon: '‚òï', category: 'drink', description: 'Caf√© s·ªØa ƒë√°' },
            { id: 'tra-dao', name: 'Tr√† ƒë√†o', price: 40000, icon: 'üçë', category: 'drink', description: 'Tr√† ƒë√†o cam s·∫£' },
            { id: 'bia', name: 'Bia Tiger', price: 45000, icon: 'üç∫', category: 'drink', description: 'Bia Tiger l·∫°nh' },
            { id: 'kem', name: 'Kem d·ª´a', price: 35000, icon: 'üç®', category: 'dessert', description: 'Kem d·ª´a s·∫ßu ri√™ng' },
            { id: 'che', name: 'Ch√® kh√∫c b·∫°ch', price: 30000, icon: 'üçÆ', category: 'dessert', description: 'Ch√® kh√∫c b·∫°ch' },
            { id: 'banh-flan', name: 'B√°nh flan', price: 25000, icon: 'üç∞', category: 'dessert', description: 'B√°nh flan caramel' }
        ];

        // Room configurations - 7 floors, 10 rooms per floor
        const FLOORS = 7;
        const ROOMS_PER_FLOOR = 10;
        const BASE_PRICE_PER_DAY = 200000; // Price for floor 1
        const PRICE_INCREMENT_PER_FLOOR = 50000; // Each floor up increases price by 50k
        
        // Room types with multipliers
        const ROOM_TYPES = {
            'standard': { name: 'Ti√™u Chu·∫©n', priceMultiplier: 1.0, icon: 'üõèÔ∏è', features: ['TV', 'WiFi', 'ƒêi·ªÅu h√≤a', 'Ph√≤ng t·∫Øm ri√™ng'] },
            'vip': { name: 'VIP', priceMultiplier: 1.5, icon: '‚≠ê', features: ['TV m√†n h√¨nh ph·∫≥ng', 'WiFi cao t·ªëc', 'Minibar', 'B·ªìn t·∫Øm', 'D·ªãch v·ª• 24/7'] },
            'suite': { name: 'Suite', priceMultiplier: 2.2, icon: 'üëë', features: ['Ph√≤ng kh√°ch ri√™ng', 'TV 2 m√†n h√¨nh', 'Minibar ƒë·∫ßy ƒë·ªß', 'B·ªìn t·∫Øm massage', 'D·ªãch v·ª• Butler', 'B·ªØa s√°ng mi·ªÖn ph√≠'] }
        };
        
        // Distribution of room types (approx)
        const ROOM_TYPE_DISTRIBUTION = {
            'standard': 0.6, // 60% standard rooms
            'vip': 0.3,      // 30% VIP rooms
            'suite': 0.1     // 10% suites
        };

        let rooms = [];
        let orders = [];
        let totalRevenue = 0;
        let todayRevenue = 0;
        let activities = [];
        let currentCheckinRoom = null;
        let currentServiceRoom = null;
        let currentOrderItems = [];
        let currentFloor = 'all';
        let currentMenuFilter = 'all';
        let currentOrderFilter = 'all';

        // Initialize all rooms
        function initializeRooms() {
            rooms = [];
            let roomCounter = 1;
            
            for (let floor = 1; floor <= FLOORS; floor++) {
                // Base price for this floor
                const floorBasePrice = BASE_PRICE_PER_DAY + ((floor - 1) * PRICE_INCREMENT_PER_FLOOR);
                
                // Determine how many of each room type on this floor
                const standardCount = Math.floor(ROOMS_PER_FLOOR * ROOM_TYPE_DISTRIBUTION.standard);
                const vipCount = Math.floor(ROOMS_PER_FLOOR * ROOM_TYPE_DISTRIBUTION.vip);
                const suiteCount = ROOMS_PER_FLOOR - standardCount - vipCount;
                
                let typeCounter = {
                    'standard': 0,
                    'vip': 0,
                    'suite': 0
                };
                
                for (let roomNum = 1; roomNum <= ROOMS_PER_FLOOR; roomNum++) {
                    // Determine room type
                    let roomType = 'standard';
                    if (typeCounter.standard < standardCount) {
                        roomType = 'standard';
                        typeCounter.standard++;
                    } else if (typeCounter.vip < vipCount) {
                        roomType = 'vip';
                        typeCounter.vip++;
                    } else {
                        roomType = 'suite';
                        typeCounter.suite++;
                    }
                    
                    // Calculate price for this room
                    const typeMultiplier = ROOM_TYPES[roomType].priceMultiplier;
                    const roomPrice = Math.floor(floorBasePrice * typeMultiplier);
                    
                    // Determine room features
                    let features = [...ROOM_TYPES[roomType].features];
                    
                    // Add special features for higher floors
                    if (floor >= 5) {
                        features.push('View th√†nh ph·ªë');
                    }
                    if (floor >= 6) {
                        features.push('Ban c√¥ng');
                    }
                    if (floor === 7 && roomType === 'suite') {
                        features.push('View to√†n c·∫£nh', 'H·ªì b∆°i ri√™ng');
                    }
                    
                    // Create room object
                    const room = {
                        id: roomCounter,
                        floor: floor,
                        roomNumber: `${floor}${roomNum.toString().padStart(2, '0')}`, // e.g., 101, 102, ..., 710
                        type: roomType,
                        pricePerDay: roomPrice,
                        customer: null,
                        customerPhone: null,
                        customerEmail: null,
                        numDays: 0,
                        checkinTime: null,
                        checkoutTime: null,
                        status: 'empty', // 'empty', 'occupied', 'cleaning'
                        specialRequests: '',
                        serviceRequests: [],
                        features: features,
                        needsCleaning: false,
                        isNew: (floor === 7 && roomType === 'suite') ? true : false, // Mark new rooms
                        hasPromo: (floor === 1 && roomNum <= 3) ? true : false // Some promo rooms on floor 1
                    };
                    
                    rooms.push(room);
                    roomCounter++;
                }
            }
            
            // Pre-populate some rooms with customers for demo
            populateDemoData();
        }
        
        // Populate some demo data
        function populateDemoData() {
            // Check in some customers
            const demoCustomers = [
                { name: 'Nguy·ªÖn VƒÉn A', phone: '0912345678', email: 'a.nguyen@email.com', days: 3, roomId: 101 },
                { name: 'Tr·∫ßn Th·ªã B', phone: '0923456789', email: 'b.tran@email.com', days: 2, roomId: 205 },
                { name: 'L√™ VƒÉn C', phone: '0934567890', email: 'c.le@email.com', days: 5, roomId: 312 },
                { name: 'Ph·∫°m Th·ªã D', phone: '0945678901', email: 'd.pham@email.com', days: 1, roomId: 407 },
                { name: 'Ho√†ng VƒÉn E', phone: '0956789012', email: 'e.hoang@email.com', days: 4, roomId: 509 },
                { name: 'ƒê·∫∑ng Th·ªã F', phone: '0967890123', email: 'f.dang@email.com', days: 3, roomId: 610 },
                { name: 'B√πi VƒÉn G', phone: '0978901234', email: 'g.bui@email.com', days: 7, roomId: 703 }
            ];
            
            demoCustomers.forEach(customer => {
                const room = rooms.find(r => r.roomNumber == customer.roomId);
                if (room) {
                    room.customer = customer.name;
                    room.customerPhone = customer.phone;
                    room.customerEmail = customer.email;
                    room.numDays = customer.days;
                    room.checkinTime = new Date(Date.now() - Math.floor(Math.random() * 86400000)); // Random time in last 24h
                    room.status = 'occupied';
                    
                    // Add to activities
                    activities.push({
                        type: 'checkin',
                        roomNumber: room.roomNumber,
                        customerName: customer.name,
                        time: room.checkinTime
                    });
                    
                    // Add some service requests
                    if (Math.random() > 0.5) {
                        const services = ['d·ªçn ph√≤ng', 'th√™m ƒë·ªì d√πng', 'gi·∫∑t ·ªßi'];
                        room.serviceRequests.push({
                            service: services[Math.floor(Math.random() * services.length)],
                            time: new Date(Date.now() - Math.floor(Math.random() * 3600000)), // Within last hour
                            completed: Math.random() > 0.5
                        });
                    }
                }
            });
            
            // Create some demo orders
            const demoOrders = [
                { roomId: 101, items: 'C∆°m g√† x 2\nN∆∞·ªõc cam x 2', status: 'completed' },
                { roomId: 205, items: 'Ph·ªü b√≤ x 1\nCaf√© s·ªØa x 1', status: 'preparing' },
                { roomId: 312, items: 'B√∫n ch·∫£ x 3\nBia Tiger x 3\nKem d·ª´a x 3', status: 'pending' },
                { roomId: 407, items: 'G·ªèi cu·ªën x 2\nC√° kho x 1\nTr√† ƒë√†o x 2', status: 'pending' }
            ];
            
            demoOrders.forEach(orderData => {
                const room = rooms.find(r => r.roomNumber == orderData.roomId);
                if (room) {
                    orders.push({
                        id: Date.now() + Math.floor(Math.random() * 1000),
                        roomId: orderData.roomId,
                        customerName: room.customer,
                        items: orderData.items,
                        time: new Date(Date.now() - Math.floor(Math.random() * 7200000)), // Within last 2 hours
                        status: orderData.status,
                        priority: orderData.status === 'pending' ? 'medium' : 'low'
                    });
                    
                    // Add to activities
                    activities.push({
                        type: 'order',
                        roomNumber: orderData.roomId,
                        customerName: room.customer,
                        time: new Date(Date.now() - Math.floor(Math.random() * 7200000))
                    });
                }
            });
            
            // Mark some rooms as needing cleaning
            rooms.filter(r => r.status === 'empty' && Math.random() > 0.7).forEach(room => {
                room.needsCleaning = true;
                room.status = 'cleaning';
                
                activities.push({
                    type: 'cleaning',
                    roomNumber: room.roomNumber,
                    time: new Date(Date.now() - Math.floor(Math.random() * 3600000))
                });
            });
            
            // Set demo revenue
            todayRevenue = 12500000;
            totalRevenue = 87500000;
        }

        // Format currency
        function formatCurrency(amount) {
            return amount.toLocaleString('vi-VN') + 'ƒë';
        }

        // Add notification
        function addNotification(message, type = 'info') {
            const notifDiv = document.createElement('div');
            notifDiv.className = `notification ${type}`;
            
            let icon = '‚ÑπÔ∏è';
            if (type === 'success') icon = '‚úÖ';
            if (type === 'warning') icon = '‚ö†Ô∏è';
            if (type === 'error') icon = '‚ùå';
            
            notifDiv.innerHTML = `
                <span style="font-size: 1.2em;">${icon}</span>
                <span>${message}</span>
            `;
            
            const notifications = document.getElementById('notifications');
            notifications.appendChild(notifDiv);
            
            setTimeout(() => {
                notifDiv.style.opacity = '0';
                notifDiv.style.transform = 'translateX(100px)';
                setTimeout(() => {
                    if (notifDiv.parentNode) {
                        notifDiv.parentNode.removeChild(notifDiv);
                    }
                }, 300);
            }, 4000);
        }

        // Switch view
        function switchView(view) {
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.querySelectorAll('.view-content').forEach(content => content.classList.remove('active'));
            document.getElementById(view + 'View').classList.add('active');
            
            if (view === 'staff') {
                renderOrders();
                renderRooms();
                updateDashboardStats();
                generateFloorButtons();
            } else if (view === 'customer') {
                updateRoomSelect();
                renderMenu();
                updateOrderSummary();
            }
        }

        // Generate floor buttons
        function generateFloorButtons() {
            const floorSelect = document.querySelector('.floor-select');
            // Clear existing buttons except "All"
            const allBtn = floorSelect.querySelector('.floor-btn');
            floorSelect.innerHTML = '';
            floorSelect.appendChild(allBtn);
            
            // Add floor buttons
            for (let floor = 1; floor <= FLOORS; floor++) {
                const floorBtn = document.createElement('button');
                floorBtn.className = 'floor-btn';
                floorBtn.textContent = floor;
                floorBtn.onclick = () => changeFloor(floor);
                floorSelect.appendChild(floorBtn);
            }
            
            // Set active button
            if (currentFloor === 'all') {
                floorSelect.querySelector('.floor-btn').classList.add('active');
            } else {
                floorSelect.querySelectorAll('.floor-btn')[currentFloor].classList.add('active');
            }
        }

        // Change floor view
        function changeFloor(floor) {
            currentFloor = floor;
            
            // Update active button
            document.querySelectorAll('.floor-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            renderRooms();
        }

        // Update room select for customers
        function updateRoomSelect() {
            const select = document.getElementById('customerRoom');
            select.innerHTML = '<option value="">-- Ch·ªçn ph√≤ng --</option>';
            
            rooms.forEach(room => {
                if (room.customer) {
                    const option = document.createElement('option');
                    option.value = room.id;
                    option.textContent = `Ph√≤ng ${room.roomNumber} - ${room.customer} (${ROOM_TYPES[room.type].name})`;
                    select.appendChild(option);
                }
            });
            
            // Also add empty rooms for new customers
            rooms.filter(room => !room.customer).forEach(room => {
                const option = document.createElement('option');
                option.value = room.id;
                const promoText = room.hasPromo ? ' [KHUY·∫æN M√ÉI]' : '';
                option.textContent = `Ph√≤ng ${room.roomNumber} - ${ROOM_TYPES[room.type].name} - ${formatCurrency(room.pricePerDay)}/ƒë√™m${promoText}`;
                select.appendChild(option);
            });
        }

        // Filter rooms by type
        function filterRoomsByType() {
            const type = document.getElementById('roomTypeFilter').value;
            const select = document.getElementById('customerRoom');
            select.innerHTML = '<option value="">-- Ch·ªçn ph√≤ng --</option>';
            
            let filteredRooms = rooms;
            if (type !== 'all') {
                filteredRooms = rooms.filter(room => room.type === type);
            }
            
            filteredRooms.forEach(room => {
                if (room.customer) {
                    const option = document.createElement('option');
                    option.value = room.id;
                    option.textContent = `Ph√≤ng ${room.roomNumber} - ${room.customer} (${ROOM_TYPES[room.type].name})`;
                    select.appendChild(option);
                } else {
                    const option = document.createElement('option');
                    option.value = room.id;
                    const promoText = room.hasPromo ? ' [KHUY·∫æN M√ÉI]' : '';
                    option.textContent = `Ph√≤ng ${room.roomNumber} - ${ROOM_TYPES[room.type].name} - ${formatCurrency(room.pricePerDay)}/ƒë√™m${promoText}`;
                    select.appendChild(option);
                }
            });
        }

        // Update room details when room is selected
        function updateRoomDetails() {
            const roomId = document.getElementById('customerRoom').value;
            const detailsDiv = document.getElementById('roomDetails');
            
            if (!roomId) {
                detailsDiv.style.display = 'none';
                return;
            }
            
            const room = rooms.find(r => r.id == roomId);
            if (!room) return;
            
            const typeInfo = ROOM_TYPES[room.type];
            
            document.getElementById('roomTypeDisplay').innerHTML = `
                <strong>${typeInfo.icon} ${typeInfo.name} - T·∫ßng ${room.floor}</strong>
            `;
            
            let priceText = formatCurrency(room.pricePerDay) + ' / ƒë√™m';
            if (room.hasPromo) {
                const discountedPrice = room.pricePerDay * 0.8; // 20% discount
                priceText = `<span style="text-decoration: line-through; color: #999;">${formatCurrency(room.pricePerDay)}</span> 
                             <span style="color: #e74c3c; font-size: 1.2em;">${formatCurrency(discountedPrice)}</span> / ƒë√™m 
                             <span style="background: #e74c3c; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8em;">GI·∫¢M 20%</span>`;
            }
            
            document.getElementById('roomPriceDisplay').innerHTML = priceText;
            
            const featuresHtml = room.features.map(feature => 
                `<div style="display: inline-block; background: #e8f4fc; padding: 5px 10px; border-radius: 15px; margin: 5px 5px 5px 0; font-size: 0.9em;">‚úì ${feature}</div>`
            ).join('');
            
            document.getElementById('roomFeatures').innerHTML = `
                <div style="margin-top: 10px; font-size: 0.9em;">
                    <div style="font-weight: bold; margin-bottom: 5px;">Ti·ªán nghi:</div>
                    ${featuresHtml}
                </div>
            `;
            
            detailsDiv.style.display = 'block';
        }

        // Render menu
        function renderMenu() {
            const grid = document.getElementById('menuGrid');
            grid.innerHTML = '';
            
            let filteredItems = MENU_ITEMS;
            if (currentMenuFilter !== 'all') {
                filteredItems = MENU_ITEMS.filter(item => item.category === currentMenuFilter);
            }
            
            filteredItems.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'menu-item';
                itemDiv.onclick = () => addToOrder(item);
                itemDiv.innerHTML = `
                    <div class="menu-icon">${item.icon}</div>
                    <div class="menu-name">${item.name}</div>
                    <div class="menu-category">${getCategoryName(item.category)}</div>
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 10px;">${item.description}</div>
                    <div class="menu-price">${formatCurrency(item.price)}</div>
                `;
                grid.appendChild(itemDiv);
            });
        }

        // Get category name
        function getCategoryName(category) {
            const names = {
                'appetizer': 'Khai v·ªã',
                'main': 'M√≥n ch√≠nh',
                'drink': 'ƒê·ªì u·ªëng',
                'dessert': 'Tr√°ng mi·ªáng'
            };
            return names[category] || category;
        }

        // Filter menu
        function filterMenu(category) {
            currentMenuFilter = category;
            
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            renderMenu();
        }

        // Add item to order
        function addToOrder(item) {
            // Check if item already in order
            const existingItem = currentOrderItems.find(i => i.id === item.id);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                currentOrderItems.push({
                    id: item.id,
                    name: item.name,
                    price: item.price,
                    quantity: 1,
                    icon: item.icon
                });
            }
            
            updateOrderSummary();
            
            // Highlight the menu item briefly
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(menuItem => {
                if (menuItem.querySelector('.menu-name').textContent === item.name) {
                    menuItem.classList.add('highlight');
                    setTimeout(() => {
                        menuItem.classList.remove('highlight');
                    }, 500);
                }
            });
        }

        // Update order summary
        function updateOrderSummary() {
            const orderItemsDiv = document.getElementById('orderItems');
            const orderTotalDiv = document.getElementById('orderTotal');
            const submitBtn = document.getElementById('submitOrderBtn');
            
            if (currentOrderItems.length === 0) {
                orderItemsDiv.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-shopping-basket"></i>
                        <p>Ch∆∞a c√≥ m√≥n n√†o trong ƒë∆°n h√†ng</p>
                        <p>H√£y ch·ªçn m√≥n t·ª´ th·ª±c ƒë∆°n b√™n tr√™n</p>
                    </div>
                `;
                orderTotalDiv.textContent = '0ƒë';
                submitBtn.disabled = true;
                return;
            }
            
            let total = 0;
            let itemsHtml = '';
            
            currentOrderItems.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                itemsHtml += `
                    <div class="order-item">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span>${item.icon}</span>
                            <span>${item.name}</span>
                        </div>
                        <div class="item-controls">
                            <button class="qty-btn" onclick="changeQuantity(${index}, -1)">-</button>
                            <span class="item-qty">${item.quantity}</span>
                            <button class="qty-btn" onclick="changeQuantity(${index}, 1)">+</button>
                            <span style="min-width: 80px; text-align: right; font-weight: bold;">${formatCurrency(itemTotal)}</span>
                            <button class="remove-btn" onclick="removeItem(${index})">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
            
            orderItemsDiv.innerHTML = itemsHtml;
            orderTotalDiv.textContent = formatCurrency(total);
            submitBtn.disabled = false;
        }

        // Change item quantity
        function changeQuantity(index, change) {
            const item = currentOrderItems[index];
            item.quantity += change;
            
            if (item.quantity <= 0) {
                currentOrderItems.splice(index, 1);
            }
            
            updateOrderSummary();
        }

        // Remove item from order
        function removeItem(index) {
            currentOrderItems.splice(index, 1);
            updateOrderSummary();
        }

        // Submit order
        function submitOrder() {
            const roomId = document.getElementById('customerRoom').value;
            const customerName = document.getElementById('customerName').value.trim();
            const customerPhone = document.getElementById('customerPhone').value.trim();
            
            if (!roomId) {
                addNotification('Vui l√≤ng ch·ªçn ph√≤ng!', 'error');
                return;
            }
            
            if (!customerName) {
                addNotification('Vui l√≤ng nh·∫≠p t√™n kh√°ch h√†ng!', 'error');
                return;
            }
            
            if (!customerPhone) {
                addNotification('Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i!', 'error');
                return;
            }
            
            if (currentOrderItems.length === 0) {
                addNotification('Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt m√≥n!', 'error');
                return;
            }
            
            const room = rooms.find(r => r.id == roomId);
            
            // Format order items
            let orderText = '';
            let orderTotal = 0;
            
            currentOrderItems.forEach(item => {
                const itemTotal = item.price * item.quantity;
                orderTotal += itemTotal;
                orderText += `${item.name} x ${item.quantity} - ${formatCurrency(itemTotal)}\n`;
            });
            
            orderText += `\nT·ªïng c·ªông: ${formatCurrency(orderTotal)}`;
            
            // Create order
            const order = {
                id: Date.now(),
                roomId: room.roomNumber,
                roomIdNum: parseInt(roomId),
                customerName: customerName,
                customerPhone: customerPhone,
                items: orderText,
                time: new Date(),
                status: 'pending',
                priority: 'medium'
            };
            
            orders.push(order);
            
            // Add to activities
            activities.push({
                type: 'order',
                roomNumber: room.roomNumber,
                customerName: customerName,
                time: new Date()
            });
            
            // Clear order
            currentOrderItems = [];
            updateOrderSummary();
            
            addNotification(`‚úÖ ƒê∆°n h√†ng t·ª´ ph√≤ng ${room.roomNumber} ƒë√£ ƒë∆∞·ª£c g·ª≠i! T·ªïng: ${formatCurrency(orderTotal)}`, 'success');
            
            // If in staff view, update orders list
            if (document.getElementById('staffView').classList.contains('active')) {
                renderOrders();
                updateDashboardStats();
            }
        }

        // Render orders for staff
        function renderOrders() {
            const list = document.getElementById('ordersList');
            
            let filteredOrders = orders;
            if (currentOrderFilter !== 'all') {
                filteredOrders = orders.filter(order => order.status === currentOrderFilter);
            }
            
            if (filteredOrders.length === 0) {
                list.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-concierge-bell"></i>
                        <p>Kh√¥ng c√≥ ƒë∆°n h√†ng n√†o</p>
                        <p>${currentOrderFilter !== 'all' ? 'Th·ª≠ ch·ªçn b·ªô l·ªçc kh√°c' : 'ƒê∆°n h√†ng s·∫Ω xu·∫•t hi·ªán ·ªü ƒë√¢y'}</p>
                    </div>
                `;
                return;
            }
            
            list.innerHTML = '';
            
            // Sort by priority and time
            filteredOrders.sort((a, b) => {
                const priorityOrder = { 'high': 3, 'medium': 2, 'low': 1 };
                if (priorityOrder[b.priority] !== priorityOrder[a.priority]) {
                    return priorityOrder[b.priority] - priorityOrder[a.priority];
                }
                return new Date(b.time) - new Date(a.time);
            });
            
            filteredOrders.forEach(order => {
                const orderDiv = document.createElement('div');
                orderDiv.className = `order-card ${order.priority === 'high' ? 'high-priority' : order.priority === 'medium' ? 'medium-priority' : ''}`;
                
                const statusColors = {
                    'pending': '#f39c12',
                    'preparing': '#3498db',
                    'completed': '#27ae60',
                    'cancelled': '#e74c3c'
                };
                
                const statusTexts = {
                    'pending': 'Ch·ªù x·ª≠ l√Ω',
                    'preparing': 'ƒêang chu·∫©n b·ªã',
                    'completed': 'Ho√†n th√†nh',
                    'cancelled': 'ƒê√£ h·ªßy'
                };
                
                const priorityTexts = {
                    'high': 'Cao',
                    'medium': 'Trung b√¨nh',
                    'low': 'Th·∫•p'
                };
                
                orderDiv.innerHTML = `
                    <div class="order-header">
                        <div class="order-room">
                            <i class="fas fa-door-closed"></i> Ph√≤ng ${order.roomId}
                            <span style="font-size: 0.9em; color: #666; margin-left: 10px;">${order.customerName}</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span class="order-priority priority-${order.priority}">${priorityTexts[order.priority]}</span>
                            <span class="order-time">
                                <i class="far fa-clock"></i> ${new Date(order.time).toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' })}
                            </span>
                        </div>
                    </div>
                    <div class="order-items">${order.items}</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="padding: 5px 15px; border-radius: 15px; background: ${statusColors[order.status]}; color: white; font-weight: bold; font-size: 0.9em;">
                                ${statusTexts[order.status]}
                            </span>
                            <span style="font-size: 0.9em; color: #666;">
                                <i class="fas fa-phone"></i> ${order.customerPhone}
                            </span>
                        </div>
                        <div class="order-actions">
                            ${order.status === 'pending' || order.status === 'preparing' ? `
                                <button class="complete-btn" onclick="updateOrderStatus(${order.id}, 'completed')">
                                    <i class="fas fa-check"></i> Ho√†n th√†nh
                                </button>
                                <button class="cancel-btn" onclick="updateOrderStatus(${order.id}, 'cancelled')">
                                    <i class="fas fa-times"></i> H·ªßy
                                </button>
                            ` : ''}
                            ${order.status === 'pending' ? `
                                <button class="complete-btn" style="background: #3498db;" onclick="updateOrderStatus(${order.id}, 'preparing')">
                                    <i class="fas fa-utensils"></i> Chu·∫©n b·ªã
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
                list.appendChild(orderDiv);
            });
        }

        // Filter orders
        function filterOrders(status) {
            currentOrderFilter = status;
            
            // Update active filter button
            const filterBtns = event.target.parentElement.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            renderOrders();
        }

        // Update order status
        function updateOrderStatus(orderId, status) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;
            
            const oldStatus = order.status;
            order.status = status;
            
            // Update priority based on waiting time if pending
            if (status === 'pending') {
                const waitTime = new Date() - new Date(order.time);
                if (waitTime > 30 * 60 * 1000) { // More than 30 minutes
                    order.priority = 'high';
                } else if (waitTime > 15 * 60 * 1000) { // More than 15 minutes
                    order.priority = 'medium';
                }
            }
            
            renderOrders();
            
            if (status === 'completed') {
                addNotification(`‚úÖ ƒê∆°n h√†ng ph√≤ng ${order.roomId} ƒë√£ ho√†n th√†nh`, 'success');
            } else if (status === 'cancelled') {
                addNotification(`‚ùå ƒê∆°n h√†ng ph√≤ng ${order.roomId} ƒë√£ h·ªßy`, 'error');
            }
        }

        // Show checkin modal
        function showCheckinModal(roomId) {
            currentCheckinRoom = roomId;
            document.getElementById('checkinModal').classList.add('active');
            document.getElementById('modalCustomerName').value = '';
            document.getElementById('modalCustomerPhone').value = '';
            document.getElementById('modalNumDays').value = '1';
            document.getElementById('modalSpecialRequests').value = '';
        }

        // Show service modal
        function showServiceModal(roomId) {
            currentServiceRoom = roomId;
            const room = rooms.find(r => r.id == roomId);
            if (!room) return;
            
            document.getElementById('serviceRoomNumber').textContent = room.roomNumber;
            document.getElementById('serviceModal').classList.add('active');
            
            // Clear checkboxes
            document.querySelectorAll('.service-checkbox').forEach(cb => cb.checked = false);
            document.getElementById('serviceNotes').value = '';
        }

        // Close modal
        function closeModal() {
            document.querySelectorAll('.modal').forEach(modal => modal.classList.remove('active'));
            currentCheckinRoom = null;
            currentServiceRoom = null;
        }

        // Confirm checkin
        function confirmCheckin() {
            const customerName = document.getElementById('modalCustomerName').value.trim();
            const customerPhone = document.getElementById('modalCustomerPhone').value.trim();
            const numDays = parseInt(document.getElementById('modalNumDays').value);
            const specialRequests = document.getElementById('modalSpecialRequests').value.trim();
            
            if (!customerName) {
                addNotification('Vui l√≤ng nh·∫≠p t√™n kh√°ch h√†ng!', 'error');
                return;
            }
            
            if (!customerPhone) {
                addNotification('Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i!', 'error');
                return;
            }
            
            if (!numDays || numDays < 1) {
                addNotification('S·ªë ng√†y thu√™ ph·∫£i l·ªõn h∆°n 0!', 'error');
                return;
            }
            
            const room = rooms.find(r => r.id === currentCheckinRoom);
            room.customer = customerName;
            room.customerPhone = customerPhone;
            room.numDays = numDays;
            room.checkinTime = new Date();
            room.status = 'occupied';
            room.specialRequests = specialRequests;
            room.needsCleaning = false;
            
            // Add to activities
            activities.push({
                type: 'checkin',
                roomNumber: room.roomNumber,
                customerName: customerName,
                time: new Date()
            });
            
            closeModal();
            renderRooms();
            updateRoomSelect();
            updateDashboardStats();
            
            addNotification(`‚úÖ ${customerName} ƒë√£ nh·∫≠n ph√≤ng ${room.roomNumber} - ${numDays} ng√†y`, 'success');
        }

        // Confirm service request
        function confirmServiceRequest() {
            const room = rooms.find(r => r.id === currentServiceRoom);
            if (!room) return;
            
            const selectedServices = Array.from(document.querySelectorAll('.service-checkbox:checked')).map(cb => cb.value);
            const notes = document.getElementById('serviceNotes').value.trim();
            
            if (selectedServices.length === 0) {
                addNotification('Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt d·ªãch v·ª•!', 'error');
                return;
            }
            
            selectedServices.forEach(service => {
                room.serviceRequests.push({
                    service: service,
                    time: new Date(),
                    completed: false,
                    notes: notes
                });
            });
            
            closeModal();
            renderRooms();
            
            addNotification(`‚úÖ ƒê√£ g·ª≠i y√™u c·∫ßu d·ªãch v·ª• cho ph√≤ng ${room.roomNumber}`, 'success');
        }

        // Checkout
        function checkout(roomId) {
            const room = rooms.find(r => r.id === roomId);
            if (!room.customer) return;
            
            const roomCharge = room.pricePerDay * room.numDays;
            
            // Apply discount for promo rooms
            const finalCharge = room.hasPromo ? roomCharge * 0.8 : roomCharge;
            
            totalRevenue += finalCharge;
            todayRevenue += finalCharge;
            
            addNotification(`üí∞ ${room.customer} tr·∫£ ph√≤ng ${room.roomNumber}. Ti·ªÅn ph√≤ng: ${formatCurrency(finalCharge)} (${room.numDays} ng√†y)`, 'success');
            
            // Add to activities
            activities.push({
                type: 'checkout',
                roomNumber: room.roomNumber,
                customerName: room.customer,
                time: new Date(),
                amount: finalCharge
            });
            
            // Mark room as needing cleaning
            room.status = 'cleaning';
            room.needsCleaning = true;
            const oldCustomer = room.customer;
            
            // Clear customer data after a delay (to show cleaning status)
            setTimeout(() => {
                room.customer = null;
                room.customerPhone = null;
                room.customerEmail = null;
                room.numDays = 0;
                room.checkinTime = null;
                room.specialRequests = '';
                renderRooms();
                updateRoomSelect();
            }, 3000);
            
            renderRooms();
            updateDashboardStats();
        }

        // Mark cleaning as done
        function markCleaningDone(roomId) {
            const room = rooms.find(r => r.id === roomId);
            room.status = 'empty';
            room.needsCleaning = false;
            room.serviceRequests = room.serviceRequests.filter(req => !req.completed);
            
            // Add to activities
            activities.push({
                type: 'cleaning',
                roomNumber: room.roomNumber,
                time: new Date(),
                action: 'completed'
            });
            
            renderRooms();
            addNotification(`üßπ Ph√≤ng ${room.roomNumber} ƒë√£ ƒë∆∞·ª£c d·ªçn xong`, 'success');
        }

        // Render rooms for staff
        function renderRooms() {
            const list = document.getElementById('roomsList');
            list.innerHTML = '';
            
            let filteredRooms = rooms;
            
            // Filter by floor
            if (currentFloor !== 'all') {
                filteredRooms = rooms.filter(room => room.floor == currentFloor);
            }
            
            if (filteredRooms.length === 0) {
                list.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <i class="fas fa-bed"></i>
                        <p>Kh√¥ng c√≥ ph√≤ng n√†o</p>
                    </div>
                `;
                return;
            }
            
            filteredRooms.forEach(room => {
                const roomDiv = document.createElement('div');
                roomDiv.className = `room-card ${room.type} ${room.status === 'occupied' ? 'occupied' : ''} ${room.needsCleaning ? 'need-cleaning' : ''}`;
                
                // Add badges
                let badges = '';
                if (room.isNew) {
                    badges += `<div class="room-badge badge-new">M·ªöI</div>`;
                }
                if (room.hasPromo) {
                    badges += `<div class="room-badge badge-promo">GI·∫¢M 20%</div>`;
                }
                if (room.floor >= 5) {
                    badges += `<div class="room-badge badge-sea-view">VIEW ƒê·∫∏P</div>`;
                }
                
                const typeInfo = ROOM_TYPES[room.type];
                
                // Customer info if occupied
                let customerInfo = '';
                let serviceRequests = '';
                let actions = '';
                
                if (room.customer) {
                    customerInfo = `
                        <div class="room-customer">
                            <i class="fas fa-user"></i> ${room.customer}
                        </div>
                        <div class="room-details">
                            <i class="fas fa-phone"></i> ${room.customerPhone}
                        </div>
                        <div class="room-details">
                            <i class="far fa-calendar"></i> ${room.numDays} ng√†y (ƒë·∫øn ${formatDate(new Date(room.checkinTime.getTime() + room.numDays * 24 * 60 * 60 * 1000))})
                        </div>
                        ${room.specialRequests ? `
                            <div class="room-details">
                                <i class="fas fa-sticky-note"></i> ${room.specialRequests.substring(0, 30)}${room.specialRequests.length > 30 ? '...' : ''}
                            </div>
                        ` : ''}
                    `;
                    
                    // Service requests
                    if (room.serviceRequests.length > 0) {
                        const pendingServices = room.serviceRequests.filter(req => !req.completed);
                        if (pendingServices.length > 0) {
                            serviceRequests = `
                                <div class="service-request">
                                    <div style="font-size: 0.9em; font-weight: bold; margin-bottom: 5px;">Y√™u c·∫ßu d·ªãch v·ª•:</div>
                                    ${pendingServices.map(req => 
                                        `<span class="service-tag">${req.service}</span>`
                                    ).join('')}
                                </div>
                            `;
                        }
                    }
                    
                    actions = `
                        <button class="room-btn checkout-btn" onclick="checkout(${room.id})">
                            <i class="fas fa-sign-out-alt"></i> Tr·∫£ ph√≤ng
                        </button>
                        <button class="room-btn service-btn" onclick="showServiceModal(${room.id})">
                            <i class="fas fa-concierge-bell"></i> D·ªãch v·ª•
                        </button>
                    `;
                } else if (room.status === 'cleaning') {
                    customerInfo = `
                        <div class="room-customer">
                            <i class="fas fa-broom"></i> ƒêang d·ªçn d·∫πp
                        </div>
                        <div class="room-details">
                            <i class="far fa-clock"></i> C·∫ßn d·ªçn tr∆∞·ªõc khi nh·∫≠n kh√°ch
                        </div>
                    `;
                    
                    actions = `
                        <button class="room-btn checkin-btn" onclick="markCleaningDone(${room.id})">
                            <i class="fas fa-check"></i> ƒê√£ d·ªçn xong
                        </button>
                    `;
                } else {
                    customerInfo = `
                        <div style="text-align: center; padding: 20px 0; color: #999;">
                            <i class="fas fa-door-open" style="font-size: 2em; margin-bottom: 10px;"></i>
                            <div>Ph√≤ng tr·ªëng</div>
                        </div>
                    `;
                    
                    actions = `
                        <button class="room-btn checkin-btn" onclick="showCheckinModal(${room.id})">
                            <i class="fas fa-key"></i> Nh·∫≠n ph√≤ng
                        </button>
                    `;
                }
                
                const roomPrice = room.hasPromo ? 
                    `<span style="text-decoration: line-through; color: #999;">${formatCurrency(room.pricePerDay)}</span>
                     <span style="color: #e74c3c;">${formatCurrency(room.pricePerDay * 0.8)}</span>` : 
                    formatCurrency(room.pricePerDay);
                
                roomDiv.innerHTML = `
                    ${badges}
                    <div class="room-header-info">
                        <div class="room-number">
                            ${typeInfo.icon} Ph√≤ng ${room.roomNumber}
                            <span class="room-type type-${room.type}">${typeInfo.name}</span>
                        </div>
                        <div class="room-status status-${room.status}">
                            ${room.status === 'occupied' ? 'ƒêang thu√™' : 
                              room.status === 'cleaning' ? 'ƒêang d·ªçn' : 'Tr·ªëng'}
                        </div>
                    </div>
                    ${customerInfo}
                    <div class="room-price">
                        <i class="fas fa-tag"></i> ${roomPrice} / ƒë√™m
                    </div>
                    ${serviceRequests}
                    <div class="room-actions">
                        ${actions}
                    </div>
                `;
                
                list.appendChild(roomDiv);
            });
        }

        // Format date
        function formatDate(date) {
            return date.toLocaleDateString('vi-VN', { day: '2-digit', month: '2-digit', year: 'numeric' });
        }

        // Update dashboard stats
        function updateDashboardStats() {
            // Calculate stats
            const occupiedRooms = rooms.filter(r => r.status === 'occupied').length;
            const cleaningRooms = rooms.filter(r => r.status === 'cleaning').length;
            const availableRooms = rooms.length - occupiedRooms - cleaningRooms;
            const occupancyRate = Math.round((occupiedRooms / rooms.length) * 100);
            
            const todayOrders = orders.filter(o => {
                const orderDate = new Date(o.time);
                const today = new Date();
                return orderDate.getDate() === today.getDate() && 
                       orderDate.getMonth() === today.getMonth() && 
                       orderDate.getFullYear() === today.getFullYear();
            }).length;
            
            // Update UI
            document.getElementById('todayRevenue').textContent = formatCurrency(todayRevenue);
            document.getElementById('occupancyRate').textContent = `${occupancyRate}%`;
            document.getElementById('availableRooms').textContent = availableRooms;
            document.getElementById('todayOrders').textContent = todayOrders;
            
            // Update activity list
            updateActivityList();
        }

        // Update activity list
        function updateActivityList() {
            const activityList = document.getElementById('activityList');
            activityList.innerHTML = '';
            
            // Get recent activities (last 10)
            const recentActivities = [...activities]
                .sort((a, b) => new Date(b.time) - new Date(a.time))
                .slice(0, 10);
            
            if (recentActivities.length === 0) {
                activityList.innerHTML = `
                    <div class="empty-state">
                        <p>Ch∆∞a c√≥ ho·∫°t ƒë·ªông n√†o</p>
                    </div>
                `;
                return;
            }
            
            recentActivities.forEach(activity => {
                const activityDiv = document.createElement('div');
                activityDiv.className = 'activity-item';
                
                let iconClass = '';
                let icon = '';
                let text = '';
                
                switch(activity.type) {
                    case 'checkin':
                        iconClass = 'icon-checkin';
                        icon = 'fas fa-key';
                        text = `<strong>${activity.customerName}</strong> nh·∫≠n ph√≤ng <strong>${activity.roomNumber}</strong>`;
                        break;
                    case 'checkout':
                        iconClass = 'icon-checkout';
                        icon = 'fas fa-sign-out-alt';
                        text = `<strong>${activity.customerName}</strong> tr·∫£ ph√≤ng <strong>${activity.roomNumber}</strong>`;
                        if (activity.amount) {
                            text += ` - ${formatCurrency(activity.amount)}`;
                        }
                        break;
                    case 'order':
                        iconClass = 'icon-order';
                        icon = 'fas fa-utensils';
                        text = `ƒê∆°n h√†ng t·ª´ ph√≤ng <strong>${activity.roomNumber}</strong> - ${activity.customerName}`;
                        break;
                    case 'cleaning':
                        iconClass = 'icon-cleaning';
                        icon = 'fas fa-broom';
                        text = `Ph√≤ng <strong>${activity.roomNumber}</strong> ${activity.action === 'completed' ? 'ƒë√£ ƒë∆∞·ª£c d·ªçn xong' : 'c·∫ßn d·ªçn d·∫πp'}`;
                        break;
                }
                
                activityDiv.innerHTML = `
                    <div class="activity-icon ${iconClass}">
                        <i class="${icon}"></i>
                    </div>
                    <div class="activity-details">
                        <div>${text}</div>
                        <div class="activity-time">
                            ${new Date(activity.time).toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' })} - 
                            ${new Date(activity.time).toLocaleDateString('vi-VN')}
                        </div>
                    </div>
                `;
                
                activityList.appendChild(activityDiv);
            });
        }

        // Initialize the system
        function initialize() {
            initializeRooms();
            updateRoomSelect();
            renderMenu();
            updateOrderSummary();
            renderOrders();
            renderRooms();
            updateDashboardStats();
            generateFloorButtons();
            
            // Show welcome notification
            setTimeout(() => {
                addNotification('Ch√†o m·ª´ng ƒë·∫øn v·ªõi H·ªá th·ªëng Qu·∫£n l√Ω Kh√°ch s·∫°n Cao c·∫•p Horizon!', 'success');
            }, 1000);
        }

        // Initialize when page loads
        window.onload = initialize;
    </script>
    <script> 
    // Th√™m v√†o ph·∫ßn JavaScript hi·ªán c√≥

// Report Management Data
let reportTemplates = {
    daily_summary: {
        name: "B√°o C√°o T·ªïng H·ª£p H√†ng Ng√†y",
        type: "daily",
        sections: ["summary", "revenue", "occupancy", "orders", "activities"]
    },
    monthly_financial: {
        name: "B√°o C√°o T√†i Ch√≠nh Th√°ng",
        type: "monthly",
        sections: ["financial_summary", "revenue_trend", "expense_breakdown", "profit_analysis", "comparisons"]
    },
    customer_analysis: {
        name: "Ph√¢n T√≠ch Kh√°ch H√†ng Chi Ti·∫øt",
        type: "analysis",
        sections: ["customer_segments", "vip_analysis", "behavior_patterns", "loyalty_program", "recommendations"]
    },
    room_performance: {
        name: "B√°o C√°o Hi·ªáu Su·∫•t Ph√≤ng",
        type: "performance",
        sections: ["occupancy_rates", "revenue_by_room", "popular_rooms", "seasonal_trends", "optimization"]
    },
    staff_performance: {
        name: "B√°o C√°o Hi·ªáu Su·∫•t Nh√¢n Vi√™n",
        type: "performance",
        sections: ["kpi_overview", "attendance", "customer_ratings", "productivity", "training_needs"]
    },
    inventory_report: {
        name: "B√°o C√°o Qu·∫£n L√Ω T·ªìn Kho",
        type: "inventory",
        sections: ["stock_levels", "consumption", "reorder_points", "wastage", "optimization"]
    }
};

let savedReports = [];

// Initialize report management
function initializeReportManagement() {
    // Load saved reports from localStorage
    const saved = localStorage.getItem('hotel_saved_reports');
    if (saved) {
        savedReports = JSON.parse(saved);
        updateSavedReportsList();
    }
    
    // Setup event listeners
    document.getElementById('reportPeriodSelect').addEventListener('change', function() {
        const customRange = document.getElementById('customDateRange');
        customRange.style.display = this.value === 'custom' ? 'block' : 'none';
    });
}

// Generate comprehensive report
function generateReport() {
    const reportType = document.getElementById('reportTypeSelect').value;
    const reportPeriod = document.getElementById('reportPeriodSelect').value;
    const filter = document.getElementById('reportFilterSelect').value;
    
    // Get date range
    let startDate, endDate;
    if (reportPeriod === 'custom') {
        startDate = document.getElementById('startDate').value;
        endDate = document.getElementById('endDate').value;
    } else {
        const today = new Date();
        switch(reportPeriod) {
            case 'daily':
                startDate = endDate = today.toISOString().split('T')[0];
                break;
            case 'weekly':
                startDate = new Date(today.setDate(today.getDate() - 7)).toISOString().split('T')[0];
                endDate = new Date().toISOString().split('T')[0];
                break;
            case 'monthly':
                startDate = new Date(today.setMonth(today.getMonth() - 1)).toISOString().split('T')[0];
                endDate = new Date().toISOString().split('T')[0];
                break;
            case 'quarterly':
                startDate = new Date(today.setMonth(today.getMonth() - 3)).toISOString().split('T')[0];
                endDate = new Date().toISOString().split('T')[0];
                break;
            case 'yearly':
                startDate = new Date(today.setFullYear(today.getFullYear() - 1)).toISOString().split('T')[0];
                endDate = new Date().toISOString().split('T')[0];
                break;
        }
    }
    
    // Generate report based on type
    let reportHTML = '';
    switch(reportType) {
        case 'financial':
            reportHTML = generateFinancialReport(startDate, endDate, filter);
            break;
        case 'occupancy':
            reportHTML = generateOccupancyReport(startDate, endDate, filter);
            break;
        case 'customer':
            reportHTML = generateCustomerReport(startDate, endDate, filter);
            break;
        case 'service':
            reportHTML = generateServiceReport(startDate, endDate, filter);
            break;
        case 'staff':
            reportHTML = generateStaffReport(startDate, endDate, filter);
            break;
        case 'inventory':
            reportHTML = generateInventoryReport(startDate, endDate, filter);
            break;
    }
    
    // Display report
    const reportArea = document.getElementById('reportDisplayArea');
    reportArea.innerHTML = reportHTML;
    reportArea.style.display = 'block';
    
    // Scroll to report
    reportArea.scrollIntoView({ behavior: 'smooth' });
    
    // Save to history
    saveReportToHistory(reportType, reportPeriod, new Date());
}

// Generate Financial Report
function generateFinancialReport(startDate, endDate, filter) {
    // Calculate financial data based on filter
    let filteredRooms = rooms;
    if (filter === 'vip') filteredRooms = rooms.filter(r => r.type === 'vip');
    if (filter === 'standard') filteredRooms = rooms.filter(r => r.type === 'standard');
    if (filter === 'suite') filteredRooms = rooms.filter(r => r.type === 'suite');
    if (filter === 'floor1-3') filteredRooms = rooms.filter(r => r.floor >= 1 && r.floor <= 3);
    if (filter === 'floor4-7') filteredRooms = rooms.filter(r => r.floor >= 4 && r.floor <= 7);
    
    // Calculate revenue from rooms
    const roomRevenue = filteredRooms.reduce((sum, room) => {
        if (room.checkinTime) {
            const checkinDate = new Date(room.checkinTime).toISOString().split('T')[0];
            if (checkinDate >= startDate && checkinDate <= endDate) {
                const hasPromo = room.badges.some(b => b.type === 'promo');
                const dailyRate = hasPromo ? room.pricePerDay * 0.8 : room.pricePerDay;
                return sum + (dailyRate * room.numDays);
            }
        }
        return sum;
    }, 0);
    
    // Calculate revenue from orders
    const orderRevenue = orders.reduce((sum, order) => {
        const orderDate = new Date(order.time).toISOString().split('T')[0];
        if (orderDate >= startDate && orderDate <= endDate) {
            // Check if room matches filter
            const room = rooms.find(r => r.roomNumber == order.roomId);
            if (room && isRoomInFilter(room, filter)) {
                return sum + (order.total || 0);
            }
        }
        return sum;
    }, 0);
    
    const totalRevenue = roomRevenue + orderRevenue;
    
    // Calculate expenses (simplified)
    const staffExpenses = managementData.staffMembers.reduce((sum, staff) => sum + staff.salary, 0);
    const operationalExpenses = totalRevenue * 0.3; // 30% of revenue
    const totalExpenses = staffExpenses + operationalExpenses;
    
    const profit = totalRevenue - totalExpenses;
    const profitMargin = totalRevenue > 0 ? (profit / totalRevenue * 100).toFixed(1) : 0;
    
    // Calculate comparisons
    const previousPeriodRevenue = totalRevenue * 0.85; // Simulated 15% less
    const revenueChange = ((totalRevenue - previousPeriodRevenue) / previousPeriodRevenue * 100).toFixed(1);
    
    return `
        <div class="report-section">
            <div class="report-header">
                <h2 style="margin: 0; color: white;"><i class="fas fa-file-invoice-dollar"></i> B√ÅO C√ÅO T√ÄI CH√çNH</h2>
                <p style="margin: 5px 0 0 0; opacity: 0.9;">${formatDateRange(startDate, endDate)} | ${getFilterName(filter)}</p>
            </div>
            
            <!-- Executive Summary -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div class="report-stat">
                    <div class="label">T·ªïng Doanh Thu</div>
                    <div class="value" style="color: #27ae60;">${formatCurrency(totalRevenue)}</div>
                    <div class="comparison-badge ${revenueChange >= 0 ? 'comparison-positive' : 'comparison-negative'}">
                        ${revenueChange >= 0 ? '+' : ''}${revenueChange}% so v·ªõi k·ª≥ tr∆∞·ªõc
                    </div>
                </div>
                
                <div class="report-stat">
                    <div class="label">T·ªïng Chi Ph√≠</div>
                    <div class="value" style="color: #e74c3c;">${formatCurrency(totalExpenses)}</div>
                    <div class="label">Trong ƒë√≥: Nh√¢n s·ª± ${formatCurrency(staffExpenses)}</div>
                </div>
                
                <div class="report-stat">
                    <div class="label">L·ª£i Nhu·∫≠n</div>
                    <div class="value" style="color: ${profit >= 0 ? '#27ae60' : '#e74c3c'};">${formatCurrency(profit)}</div>
                    <div class="label">T·ª∑ su·∫•t l·ª£i nhu·∫≠n: ${profitMargin}%</div>
                </div>
                
                <div class="report-stat">
                    <div class="label">Doanh Thu TB/Ng√†y</div>
                    <div class="value" style="color: #3498db;">${formatCurrency(totalRevenue / getDaysBetween(startDate, endDate))}</div>
                    <div class="label">${getDaysBetween(startDate, endDate)} ng√†y</div>
                </div>
            </div>
            
            <!-- Revenue Breakdown -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-chart-pie"></i> Ph√¢n B·ªï Doanh Thu
            </h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                <div>
                    <h4 style="color: #666; margin-bottom: 15px;">Theo Ngu·ªìn Thu</h4>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>Ph√≤ng ·ªêc</span>
                                <span style="font-weight: bold;">${formatCurrency(roomRevenue)}</span>
                            </div>
                            <div style="height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden;">
                                <div style="width: ${totalRevenue > 0 ? (roomRevenue / totalRevenue * 100) : 0}%; height: 100%; background: #3498db;"></div>
                            </div>
                            <div style="text-align: right; font-size: 0.9em; color: #666; margin-top: 5px;">
                                ${totalRevenue > 0 ? ((roomRevenue / totalRevenue * 100).toFixed(1)) : 0}%
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span>Nh√† H√†ng</span>
                                <span style="font-weight: bold;">${formatCurrency(orderRevenue)}</span>
                            </div>
                            <div style="height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden;">
                                <div style="width: ${totalRevenue > 0 ? (orderRevenue / totalRevenue * 100) : 0}%; height: 100%; background: #27ae60;"></div>
                            </div>
                            <div style="text-align: right; font-size: 0.9em; color: #666; margin-top: 5px;">
                                ${totalRevenue > 0 ? ((orderRevenue / totalRevenue * 100).toFixed(1)) : 0}%
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 style="color: #666; margin-bottom: 15px;">Theo Lo·∫°i Ph√≤ng</h4>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        ${['standard', 'vip', 'suite'].map(type => {
                            const typeRevenue = filteredRooms
                                .filter(r => r.type === type)
                                .reduce((sum, room) => {
                                    if (room.checkinTime) {
                                        const checkinDate = new Date(room.checkinTime).toISOString().split('T')[0];
                                        if (checkinDate >= startDate && checkinDate <= endDate) {
                                            const hasPromo = room.badges.some(b => b.type === 'promo');
                                            const dailyRate = hasPromo ? room.pricePerDay * 0.8 : room.pricePerDay;
                                            return sum + (dailyRate * room.numDays);
                                        }
                                    }
                                    return sum;
                                }, 0);
                            
                            const colors = { standard: '#3498db', vip: '#f1c40f', suite: '#9b59b6' };
                            const names = { standard: 'Ti√™u Chu·∫©n', vip: 'VIP', suite: 'Suite' };
                            
                            return `
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                        <span>${names[type]}</span>
                                        <span style="font-weight: bold;">${formatCurrency(typeRevenue)}</span>
                                    </div>
                                    <div style="height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden;">
                                        <div style="width: ${roomRevenue > 0 ? (typeRevenue / roomRevenue * 100) : 0}%; height: 100%; background: ${colors[type]};"></div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            </div>
            
            <!-- Financial Trends -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-chart-line"></i> Xu H∆∞·ªõng T√†i Ch√≠nh
            </h3>
            
            <div class="report-chart" id="financialTrendChart">
                <!-- Chart will be generated dynamically -->
                ${generateFinancialTrendChart(startDate, endDate)}
            </div>
            
            <!-- Expense Breakdown -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-money-bill-wave"></i> Ph√¢n T√≠ch Chi Ph√≠
            </h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h4 style="color: #e74c3c; margin-bottom: 15px;">Chi Ph√≠ Nh√¢n S·ª±</h4>
                    <div style="font-size: 2em; font-weight: bold; color: #e74c3c; margin-bottom: 10px;">
                        ${formatCurrency(staffExpenses)}
                    </div>
                    <div style="color: #666;">
                        ${managementData.staffMembers.length} nh√¢n vi√™n<br>
                        Trung b√¨nh: ${formatCurrency(staffExpenses / managementData.staffMembers.length)}/ng∆∞·ªùi
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h4 style="color: #f39c12; margin-bottom: 15px;">Chi Ph√≠ V·∫≠t T∆∞</h4>
                    <div style="font-size: 2em; font-weight: bold; color: #f39c12; margin-bottom: 10px;">
                        ${formatCurrency(operationalExpenses * 0.4)}
                    </div>
                    <div style="color: #666;">
                        40% chi ph√≠ v·∫≠n h√†nh<br>
                        Ch·ªß y·∫øu: Th·ª±c ph·∫©m, v·ªá sinh
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h4 style="color: #9b59b6; margin-bottom: 15px;">Chi Ph√≠ Kh√°c</h4>
                    <div style="font-size: 2em; font-weight: bold; color: #9b59b6; margin-bottom: 10px;">
                        ${formatCurrency(operationalExpenses * 0.6)}
                    </div>
                    <div style="color: #666;">
                        60% chi ph√≠ v·∫≠n h√†nh<br>
                        ƒêi·ªán, n∆∞·ªõc, b·∫£o tr√¨, marketing
                    </div>
                </div>
            </div>
            
            <!-- Key Insights -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-lightbulb"></i> Ph√¢n T√≠ch & ƒê·ªÅ Xu·∫•t
            </h3>
            
            <div style="margin-bottom: 30px;">
                <div class="insight-card ${profitMargin >= 20 ? 'success' : profitMargin >= 10 ? 'warning' : 'danger'}">
                    <h4 style="margin: 0 0 10px 0;">
                        <i class="fas ${profitMargin >= 20 ? 'fa-check-circle' : profitMargin >= 10 ? 'fa-exclamation-triangle' : 'fa-exclamation-circle'}"></i>
                        T·ª∑ Su·∫•t L·ª£i Nhu·∫≠n: ${profitMargin}%
                    </h4>
                    <p style="margin: 0;">
                        ${profitMargin >= 20 ? 
                            'T·ª∑ su·∫•t l·ª£i nhu·∫≠n r·∫•t t·ªët. Ti·∫øp t·ª•c duy tr√¨ hi·ªáu qu·∫£ v·∫≠n h√†nh.' :
                          profitMargin >= 10 ?
                            'T·ª∑ su·∫•t l·ª£i nhu·∫≠n ·ªü m·ª©c trung b√¨nh. C·∫ßn t·ªëi ∆∞u chi ph√≠.' :
                            'T·ª∑ su·∫•t l·ª£i nhu·∫≠n th·∫•p. C·∫ßn xem x√©t l·∫°i chi·∫øn l∆∞·ª£c gi√° v√† ki·ªÉm so√°t chi ph√≠.'
                        }
                    </p>
                </div>
                
                <div class="insight-card ${roomRevenue > orderRevenue * 2 ? 'success' : 'warning'}">
                    <h4 style="margin: 0 0 10px 0;">
                        <i class="fas ${roomRevenue > orderRevenue * 2 ? 'fa-check-circle' : 'fa-exclamation-triangle'}"></i>
                        C∆° C·∫•u Doanh Thu
                    </h4>
                    <p style="margin: 0;">
                        ${roomRevenue > orderRevenue * 2 ?
                            'Doanh thu ph√≤ng chi·∫øm ∆∞u th·∫ø. Tuy nhi√™n n√™n ph√°t tri·ªÉn th√™m d·ªãch v·ª• nh√† h√†ng.' :
                            'Doanh thu nh√† h√†ng ƒë√≥ng g√≥p ƒë√°ng k·ªÉ. Ti·∫øp t·ª•c ph√°t huy th·∫ø m·∫°nh d·ªãch v·ª• ƒÉn u·ªëng.'
                        }
                    </p>
                </div>
                
                <div class="insight-card ${revenueChange >= 0 ? 'success' : 'danger'}">
                    <h4 style="margin: 0 0 10px 0;">
                        <i class="fas ${revenueChange >= 0 ? 'fa-chart-line' : 'fa-chart-line-down'}"></i>
                        TƒÉng Tr∆∞·ªüng Doanh Thu: ${revenueChange}%
                    </h4>
                    <p style="margin: 0;">
                        ${revenueChange >= 0 ?
                            `Doanh thu tƒÉng ${revenueChange}% so v·ªõi k·ª≥ tr∆∞·ªõc. Xu h∆∞·ªõng t√≠ch c·ª±c.` :
                            `Doanh thu gi·∫£m ${Math.abs(revenueChange)}% so v·ªõi k·ª≥ tr∆∞·ªõc. C·∫ßn ph√¢n t√≠ch nguy√™n nh√¢n.`
                        }
                    </p>
                </div>
            </div>
            
            <!-- Recommendations -->
            <div style="background: #e8f4fc; padding: 20px; border-radius: 10px; border-left: 4px solid #3498db;">
                <h4 style="margin: 0 0 15px 0; color: #2c3e50;">
                    <i class="fas fa-bullseye"></i> ƒê·ªÅ Xu·∫•t H√†nh ƒê·ªông
                </h4>
                <ul style="margin: 0; padding-left: 20px;">
                    ${profitMargin < 15 ? '<li>Ki·ªÉm so√°t ch·∫∑t chi ph√≠ v·∫≠n h√†nh, ƒë·∫∑c bi·ªát l√† ƒëi·ªán n∆∞·ªõc</li>' : ''}
                    ${roomRevenue > orderRevenue * 3 ? '<li>ƒê·∫©y m·∫°nh d·ªãch v·ª• nh√† h√†ng v·ªõi combo khuy·∫øn m√£i</li>' : ''}
                    ${revenueChange < 5 ? '<li>TƒÉng c∆∞·ªùng marketing m√πa th·∫•p ƒëi·ªÉm</li>' : ''}
                    <li>T·ªëi ∆∞u h√≥a gi√° ph√≤ng theo m√πa v√† ƒë·ªëi th·ªß</li>
                    <li>Ph√°t tri·ªÉn g√≥i d·ªãch v·ª• cao c·∫•p cho kh√°ch VIP</li>
                    <li>ƒê√†o t·∫°o nh√¢n vi√™n n√¢ng cao ch·∫•t l∆∞·ª£ng d·ªãch v·ª•</li>
                </ul>
            </div>
            
            <!-- Footer -->
            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e9ecef; color: #666; font-size: 0.9em;">
                <p>B√°o c√°o ƒë∆∞·ª£c t·∫°o t·ª± ƒë·ªông v√†o ${new Date().toLocaleString('vi-VN')}</p>
                <p>H·ªá th·ªëng Qu·∫£n l√Ω Kh√°ch s·∫°n Horizon - Phi√™n b·∫£n 2.0</p>
            </div>
        </div>
    `;
}

// Generate Occupancy Report
function generateOccupancyReport(startDate, endDate, filter) {
    // Calculate occupancy data
    const totalRooms = rooms.length;
    let filteredRooms = rooms;
    
    if (filter === 'floor1-3') filteredRooms = rooms.filter(r => r.floor >= 1 && r.floor <= 3);
    if (filter === 'floor4-7') filteredRooms = rooms.filter(r => r.floor >= 4 && r.floor <= 7);
    
    const totalFilteredRooms = filteredRooms.length;
    
    // Calculate occupancy rates
    const occupiedRooms = filteredRooms.filter(r => r.status === 'occupied').length;
    const cleaningRooms = filteredRooms.filter(r => r.status === 'cleaning').length;
    const availableRooms = totalFilteredRooms - occupiedRooms - cleaningRooms;
    
    const occupancyRate = totalFilteredRooms > 0 ? (occupiedRooms / totalFilteredRooms * 100).toFixed(1) : 0;
    const cleaningRate = totalFilteredRooms > 0 ? (cleaningRooms / totalFilteredRooms * 100).toFixed(1) : 0;
    const availabilityRate = totalFilteredRooms > 0 ? (availableRooms / totalFilteredRooms * 100).toFixed(1) : 0;
    
    // Calculate by room type
    const roomTypeStats = {};
    ['standard', 'vip', 'suite'].forEach(type => {
        const typeRooms = filteredRooms.filter(r => r.type === type);
        const occupiedTypeRooms = typeRooms.filter(r => r.status === 'occupied').length;
        roomTypeStats[type] = {
            total: typeRooms.length,
            occupied: occupiedTypeRooms,
            rate: typeRooms.length > 0 ? (occupiedTypeRooms / typeRooms.length * 100).toFixed(1) : 0
        };
    });
    
    // Calculate by floor
    const floorStats = {};
    for (let floor = 1; floor <= 7; floor++) {
        const floorRooms = filteredRooms.filter(r => r.floor === floor);
        const occupiedFloorRooms = floorRooms.filter(r => r.status === 'occupied').length;
        floorStats[floor] = {
            total: floorRooms.length,
            occupied: occupiedFloorRooms,
            rate: floorRooms.length > 0 ? (occupiedFloorRooms / floorRooms.length * 100).toFixed(1) : 0
        };
    }
    
    // Find most popular rooms
    const popularRooms = [...filteredRooms]
        .sort((a, b) => b.bookingCount - a.bookingCount)
        .slice(0, 5);
    
    return `
        <div class="report-section">
            <div class="report-header">
                <h2 style="margin: 0; color: white;"><i class="fas fa-bed"></i> B√ÅO C√ÅO PH√íNG ·ªêC</h2>
                <p style="margin: 5px 0 0 0; opacity: 0.9;">${formatDateRange(startDate, endDate)} | ${getFilterName(filter)}</p>
            </div>
            
            <!-- Occupancy Overview -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div class="report-stat">
                    <div class="label">T·ª∑ L·ªá Thu√™ Ph√≤ng</div>
                    <div class="value" style="color: #27ae60;">${occupancyRate}%</div>
                    <div class="label">${occupiedRooms}/${totalFilteredRooms} ph√≤ng</div>
                </div>
                
                <div class="report-stat">
                    <div class="label">Ph√≤ng ƒêang D·ªçn</div>
                    <div class="value" style="color: #f39c12;">${cleaningRate}%</div>
                    <div class="label">${cleaningRooms} ph√≤ng</div>
                </div>
                
                <div class="report-stat">
                    <div class="label">Ph√≤ng Tr·ªëng</div>
                    <div class="value" style="color: #3498db;">${availabilityRate}%</div>
                    <div class="label">${availableRooms} ph√≤ng s·∫µn s√†ng</div>
                </div>
                
                <div class="report-stat">
                    <div class="label">T·ªïng S·ªë Ph√≤ng</div>
                    <div class="value" style="color: #9b59b6;">${totalFilteredRooms}</div>
                    <div class="label">${totalRooms} ph√≤ng to√†n kh√°ch s·∫°n</div>
                </div>
            </div>
            
            <!-- Occupancy by Room Type -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-chart-pie"></i> T·ª∑ L·ªá Thu√™ Theo Lo·∫°i Ph√≤ng
            </h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                ${['standard', 'vip', 'suite'].map(type => {
                    const stats = roomTypeStats[type];
                    const colors = { standard: '#3498db', vip: '#f1c40f', suite: '#9b59b6' };
                    const names = { standard: 'Ti√™u Chu·∫©n', vip: 'VIP', suite: 'Suite' };
                    
                    return `
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <h4 style="margin: 0; color: ${colors[type]};">${names[type]}</h4>
                                <span style="font-size: 1.5em; font-weight: bold;">${stats.rate}%</span>
                            </div>
                            <div style="height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden; margin-bottom: 10px;">
                                <div style="width: ${stats.rate}%; height: 100%; background: ${colors[type]};"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; color: #666; font-size: 0.9em;">
                                <span>${stats.occupied}/${stats.total} ph√≤ng</span>
                                <span>${stats.total > 0 ? ((stats.occupied / stats.total * 100).toFixed(1)) : 0}%</span>
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>
            
            <!-- Occupancy by Floor -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-building"></i> T·ª∑ L·ªá Thu√™ Theo T·∫ßng
            </h3>
            
            <div class="report-chart">
                ${Object.keys(floorStats).map(floor => {
                    const stats = floorStats[floor];
                    const height = stats.total > 0 ? (stats.rate / 100 * 80) + 20 : 20;
                    
                    return `
                        <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                            <div style="width: 80%; height: ${height}%; background: linear-gradient(to top, #27ae60, #2ecc71); border-radius: 5px 5px 0 0; position: relative;">
                                <div style="position: absolute; top: -25px; left: 0; right: 0; text-align: center; font-size: 0.9em; font-weight: bold;">
                                    ${stats.rate}%
                                </div>
                            </div>
                            <div style="margin-top: 5px; font-size: 0.9em; color: #666;">
                                T·∫ßng ${floor}<br>
                                <small>${stats.occupied}/${stats.total}</small>
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>
            
            <!-- Most Popular Rooms -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-star"></i> Ph√≤ng Ph·ªï Bi·∫øn Nh·∫•t
            </h3>
            
            <div style="overflow-x: auto; margin-bottom: 30px;">
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>S·ªë Ph√≤ng</th>
                            <th>Lo·∫°i</th>
                            <th>T·∫ßng</th>
                            <th>S·ªë L·∫ßn Thu√™</th>
                            <th>T·ª∑ L·ªá Thu√™</th>
                            <th>Doanh Thu</th>
                            <th>ƒê√°nh Gi√°</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${popularRooms.map((room, index) => `
                            <tr>
                                <td>${index + 1}</td>
                                <td><strong>${room.roomNumber}</strong></td>
                                <td><span class="room-type type-${room.type}">${ROOM_TYPES[room.type].name}</span></td>
                                <td>T·∫ßng ${room.floor}</td>
                                <td>${room.bookingCount}</td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <span>${room.occupancyRate}%</span>
                                        <div style="flex: 1; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden;">
                                            <div style="width: ${room.occupancyRate}%; height: 100%; background: #27ae60;"></div>
                                        </div>
                                    </div>
                                </td>
                                <td>${formatCurrency(room.totalRevenue)}</td>
                                <td>
                                    ${room.occupancyRate >= 80 ? '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê' :
                                      room.occupancyRate >= 60 ? '‚≠ê‚≠ê‚≠ê‚≠ê' :
                                      room.occupancyRate >= 40 ? '‚≠ê‚≠ê‚≠ê' :
                                      room.occupancyRate >= 20 ? '‚≠ê‚≠ê' : '‚≠ê'}
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
            
            <!-- Room Performance Insights -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-chart-line"></i> Ph√¢n T√≠ch Hi·ªáu Su·∫•t
            </h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <!-- Best Performing Room -->
                <div style="background: #d4edda; padding: 20px; border-radius: 10px; border-left: 4px solid #27ae60;">
                    <h4 style="margin: 0 0 10px 0; color: #155724;">
                        <i class="fas fa-trophy"></i> Ph√≤ng T·ªët Nh·∫•t
                    </h4>
                    ${(() => {
                        const bestRoom = popularRooms[0];
                        return bestRoom ? `
                            <p style="margin: 0 0 10px 0;">
                                <strong>Ph√≤ng ${bestRoom.roomNumber}</strong><br>
                                T·ª∑ l·ªá thu√™: ${bestRoom.occupancyRate}%<br>
                                Doanh thu: ${formatCurrency(bestRoom.totalRevenue)}<br>
                                S·ªë l·∫ßn thu√™: ${bestRoom.bookingCount}
                            </p>
                        ` : '<p style="margin: 0;">Kh√¥ng c√≥ d·ªØ li·ªáu</p>';
                    })()}
                </div>
                
                <!-- Underperforming Rooms -->
                <div style="background: #f8d7da; padding: 20px; border-radius: 10px; border-left: 4px solid #e74c3c;">
                    <h4 style="margin: 0 0 10px 0; color: #721c24;">
                        <i class="fas fa-exclamation-triangle"></i> C·∫ßn C·∫£i Thi·ªán
                    </h4>
                    ${(() => {
                        const underperforming = filteredRooms
                            .filter(r => r.occupancyRate < 30)
                            .slice(0, 3);
                        
                        if (underperforming.length > 0) {
                            return `
                                <p style="margin: 0 0 10px 0;">
                                    ${underperforming.map(r => `Ph√≤ng ${r.roomNumber} (${r.occupancyRate}%)`).join(', ')}
                                </p>
                                <p style="margin: 0; font-size: 0.9em;">
                                    C·∫ßn xem x√©t: ƒëi·ªÅu ch·ªânh gi√°, c·∫£i thi·ªán ti·ªán nghi, tƒÉng c∆∞·ªùng marketing
                                </p>
                            `;
                        } else {
                            return '<p style="margin: 0;">Kh√¥ng c√≥ ph√≤ng n√†o c·∫ßn c·∫£i thi·ªán</p>';
                        }
                    })()}
                </div>
                
                <!-- Seasonal Analysis -->
                <div style="background: #fff3cd; padding: 20px; border-radius: 10px; border-left: 4px solid #f39c12;">
                    <h4 style="margin: 0 0 10px 0; color: #856404;">
                        <i class="fas fa-calendar-alt"></i> Ph√¢n T√≠ch M√πa V·ª•
                    </h4>
                    <p style="margin: 0;">
                        ${occupancyRate >= 70 ? 
                            'M√πa cao ƒëi·ªÉm - TƒÉng gi√° t·ªëi ∆∞u doanh thu' :
                          occupancyRate >= 40 ?
                            'M√πa trung b√¨nh - √Åp d·ª•ng khuy·∫øn m√£i' :
                            'M√πa th·∫•p ƒëi·ªÉm - C·∫ßn chi·∫øn l∆∞·ª£c ƒë·∫∑c bi·ªát'
                        }
                    </p>
                    <p style="margin: 10px 0 0 0; font-size: 0.9em;">
                        ƒê·ªÅ xu·∫•t: ${occupancyRate >= 70 ? 
                            'M·ªü b√°n tr∆∞·ªõc, tƒÉng gi√° dynamic' :
                            'Combo d·ªãch v·ª•, khuy·∫øn m√£i d√†i h·∫°n'
                        }
                    </p>
                </div>
            </div>
            
            <!-- Recommendations -->
            <div style="background: #e8f4fc; padding: 20px; border-radius: 10px; border-left: 4px solid #3498db;">
                <h4 style="margin: 0 0 15px 0; color: #2c3e50;">
                    <i class="fas fa-bullseye"></i> Chi·∫øn L∆∞·ª£c T·ªëi ∆Øu
                </h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                    <div>
                        <h5 style="margin: 0 0 10px 0; color: #666;">üìà TƒÉng T·ª∑ L·ªá Thu√™</h5>
                        <ul style="margin: 0; padding-left: 20px; font-size: 0.9em;">
                            <li>Dynamic pricing theo demand</li>
                            <li>Package d·ªãch v·ª• gi√° tr·ªã gia tƒÉng</li>
                            <li>Upsell ph√≤ng cao c·∫•p</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h5 style="margin: 0 0 10px 0; color: #666;">üí∞ T·ªëi ∆Øu Doanh Thu</h5>
                        <ul style="margin: 0; padding-left: 20px; font-size: 0.9em;">
                            <li>Ph√¢n kh√∫c gi√° theo t·∫ßng</li>
                            <li>Khuy·∫øn m√£i m√πa th·∫•p ƒëi·ªÉm</li>
                            <li>Bundle nh√† h√†ng + ph√≤ng</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h5 style="margin: 0 0 10px 0; color: #666;">üéØ C·∫£i Thi·ªán Hi·ªáu Su·∫•t</h5>
                        <ul style="margin: 0; padding-left: 20px; font-size: 0.9em;">
                            <li>Turnaround time d·ªçn ph√≤ng</li>
                            <li>Predictive maintenance</li>
                            <li>Staff training chuy√™n s√¢u</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Footer -->
            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e9ecef; color: #666; font-size: 0.9em;">
                <p>B√°o c√°o ƒë∆∞·ª£c t·∫°o t·ª± ƒë·ªông v√†o ${new Date().toLocaleString('vi-VN')}</p>
                <p>Ch·ªâ s·ªë ƒë√°nh gi√° d·ª±a tr√™n d·ªØ li·ªáu l·ªãch s·ª≠ v√† ph√¢n t√≠ch th·ª±c t·∫ø</p>
            </div>
        </div>
    `;
}

// Generate Customer Analysis Report
function generateCustomerReport(startDate, endDate, filter) {
    // Customer statistics
    const vipCustomers = managementData.customerHistory.filter(c => c.isVip).length;
    const repeatCustomers = managementData.customerHistory.filter(c => c.visits > 1).length;
    const totalCustomers = managementData.customerHistory.length;
    
    // Calculate average spending
    const totalSpending = managementData.customerHistory.reduce((sum, c) => sum + c.totalSpent, 0);
    const avgSpending = totalCustomers > 0 ? totalSpending / totalCustomers : 0;
    
    // Customer segmentation
    const segments = {
        vip_high: managementData.customerHistory.filter(c => c.isVip && c.totalSpent > 10000000).length,
        vip_medium: managementData.customerHistory.filter(c => c.isVip && c.totalSpent <= 10000000).length,
        regular_high: managementData.customerHistory.filter(c => !c.isVip && c.totalSpent > 5000000).length,
        regular_low: managementData.customerHistory.filter(c => !c.isVip && c.totalSpent <= 5000000).length
    };
    
    // Room type preference
    const roomPreferences = {};
    managementData.customerHistory.forEach(customer => {
        if (!roomPreferences[customer.roomType]) {
            roomPreferences[customer.roomType] = 0;
        }
        roomPreferences[customer.roomType]++;
    });
    
    // Customer retention rate (simplified)
    const retentionRate = totalCustomers > 0 ? (repeatCustomers / totalCustomers * 100).toFixed(1) : 0;
    
    return `
        <div class="report-section">
            <div class="report-header">
                <h2 style="margin: 0; color: white;"><i class="fas fa-users"></i> PH√ÇN T√çCH KH√ÅCH H√ÄNG</h2>
                <p style="margin: 5px 0 0 0; opacity: 0.9;">${formatDateRange(startDate, endDate)} | ${getFilterName(filter)}</p>
            </div>
            
            <!-- Customer Overview -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div class="report-stat">
                    <div class="label">T·ªïng Kh√°ch H√†ng</div>
                    <div class="value" style="color: #3498db;">${totalCustomers}</div>
                    <div class="label">${new Date().getFullYear()}</div>
                </div>
                
                <div class="report-stat">
                    <div class="label">Kh√°ch VIP</div>
                    <div class="value" style="color: #f1c40f;">${vipCustomers}</div>
                    <div class="label">${totalCustomers > 0 ? ((vipCustomers / totalCustomers * 100).toFixed(1)) : 0}%</div>
                </div>
                
                <div class="report-stat">
                    <div class="label">Kh√°ch Quay L·∫°i</div>
                    <div class="value" style="color: #27ae60;">${repeatCustomers}</div>
                    <div class="label">T·ª∑ l·ªá gi·ªØ ch√¢n: ${retentionRate}%</div>
                </div>
                
                <div class="report-stat">
                    <div class="label">Chi Ti√™u Trung B√¨nh</div>
                    <div class="value" style="color: #9b59b6;">${formatCurrency(avgSpending)}</div>
                    <div class="label">T·ªïng: ${formatCurrency(totalSpending)}</div>
                </div>
            </div>
            
            <!-- Customer Segmentation -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-chart-pie"></i> Ph√¢n Kh√∫c Kh√°ch H√†ng
            </h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                ${Object.entries({
                    'vip_high': { name: 'VIP Cao C·∫•p', color: '#f1c40f', description: 'Chi ti√™u > 10tr' },
                    'vip_medium': { name: 'VIP Trung B√¨nh', color: '#f39c12', description: 'Chi ti√™u ‚â§ 10tr' },
                    'regular_high': { name: 'Th∆∞·ªùng Cao', color: '#3498db', description: 'Chi ti√™u > 5tr' },
                    'regular_low': { name: 'Th∆∞·ªùng Th·∫•p', color: '#2980b9', description: 'Chi ti√™u ‚â§ 5tr' }
                }).map(([key, info]) => {
                    const count = segments[key];
                    const percentage = totalCustomers > 0 ? (count / totalCustomers * 100).toFixed(1) : 0;
                    
                    return `
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid ${info.color};">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <h4 style="margin: 0; color: ${info.color};">${info.name}</h4>
                                <span style="font-size: 1.5em; font-weight: bold;">${count}</span>
                            </div>
                            <p style="margin: 0 0 10px 0; color: #666; font-size: 0.9em;">${info.description}</p>
                            <div style="height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden;">
                                <div style="width: ${percentage}%; height: 100%; background: ${info.color};"></div>
                            </div>
                            <div style="text-align: right; margin-top: 5px; font-size: 0.9em; color: #666;">
                                ${percentage}% t·ªïng kh√°ch h√†ng
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>
            
            <!-- Room Type Preferences -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-bed"></i> Xu H∆∞·ªõng Ch·ªçn Ph√≤ng
            </h3>
            
            <div class="report-chart">
                ${Object.entries(roomPreferences).map(([type, count]) => {
                    const percentage = totalCustomers > 0 ? (count / totalCustomers * 100).toFixed(1) : 0;
                    const height = totalCustomers > 0 ? (percentage / 100 * 80) + 20 : 20;
                    const colors = { standard: '#3498db', vip: '#f1c40f', suite: '#9b59b6' };
                    const names = { standard: 'Ti√™u Chu·∫©n', vip: 'VIP', suite: 'Suite' };
                    
                    return `
                        <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                            <div style="width: 80%; height: ${height}%; background: ${colors[type]}; border-radius: 5px 5px 0 0; position: relative;">
                                <div style="position: absolute; top: -25px; left: 0; right: 0; text-align: center; font-size: 0.9em; font-weight: bold; color: ${colors[type]};">
                                    ${percentage}%
                                </div>
                            </div>
                            <div style="margin-top: 5px; font-size: 0.9em; color: #666; text-align: center;">
                                ${names[type]}<br>
                                <small>${count} kh√°ch</small>
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>
            
            <!-- Top Customers -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-crown"></i> Kh√°ch H√†ng Gi√° Tr·ªã Nh·∫•t
            </h3>
            
            <div style="overflow-x: auto; margin-bottom: 30px;">
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>H·∫°ng</th>
                            <th>T√™n Kh√°ch H√†ng</th>
                            <th>S·ªë L·∫ßn Thu√™</th>
                            <th>T·ªïng Chi Ti√™u</th>
                            <th>Lo·∫°i Ph√≤ng ∆Øa Th√≠ch</th>
                            <th>T√¨nh Tr·∫°ng VIP</th>
                            <th>ƒê·ªÅ Xu·∫•t</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${managementData.customerHistory
                            .sort((a, b) => b.totalSpent - a.totalSpent)
                            .slice(0, 10)
                            .map((customer, index) => `
                                <tr>
                                    <td>
                                        <div style="width: 30px; height: 30px; background: ${index < 3 ? '#f1c40f' : '#3498db'}; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">
                                            ${index + 1}
                                        </div>
                                    </td>
                                    <td><strong>${customer.name}</strong></td>
                                    <td>${customer.visits} l·∫ßn</td>
                                    <td>${formatCurrency(customer.totalSpent)}</td>
                                    <td><span class="room-type type-${customer.roomType}">${ROOM_TYPES[customer.roomType]?.name || customer.roomType}</span></td>
                                    <td>
                                        <span class="status-badge ${customer.isVip ? 'status-active' : 'status-inactive'}">
                                            ${customer.isVip ? 'VIP' : 'Th∆∞·ªùng'}
                                        </span>
                                    </td>
                                    <td>
                                        ${customer.isVip ? 
                                            '<span style="color: #27ae60;">∆Øu ƒë√£i ƒë·∫∑c bi·ªát</span>' :
                                            customer.totalSpent > 5000000 ?
                                            '<span style="color: #3498db;">Xem x√©t n√¢ng VIP</span>' :
                                            '<span style="color: #666;">Khuy·∫øn m√£i th∆∞·ªùng</span>'
                                        }
                                    </td>
                                </tr>
                            `).join('')}
                    </tbody>
                </table>
            </div>
            
            <!-- Customer Behavior Analysis -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-brain"></i> Ph√¢n T√≠ch H√†nh Vi
            </h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div style="background: #e8f4fc; padding: 20px; border-radius: 10px;">
                    <h4 style="margin: 0 0 15px 0; color: #3498db;">
                        <i class="fas fa-calendar-check"></i> M√¥ H√¨nh ƒê·∫∑t Ph√≤ng
                    </h4>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>60% ƒë·∫∑t tr∆∞·ªõc 7+ ng√†y</li>
                        <li>25% ƒë·∫∑t last-minute</li>
                        <li>15% walk-in</li>
                        <li>Trung b√¨nh: 3.2 ng√†y/l·∫ßn thu√™</li>
                    </ul>
                </div>
                
                <div style="background: #d4edda; padding: 20px; border-radius: 10px;">
                    <h4 style="margin: 0 0 15px 0; color: #27ae60;">
                        <i class="fas fa-utensils"></i> Ti√™u D√πng D·ªãch V·ª•
                    </h4>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>80% s·ª≠ d·ª•ng nh√† h√†ng</li>
                        <li>45% s·ª≠ d·ª•ng d·ªãch v·ª• ph√≤ng</li>
                        <li>30% ƒë·∫∑t tour/ƒë∆∞a ƒë√≥n</li>
                        <li>Chi ti√™u TB d·ªãch v·ª•: 450k/ng√†y</li>
                    </ul>
                </div>
                
                <div style="background: #fff3cd; padding: 20px; border-radius: 10px;">
                    <h4 style="margin: 0 0 15px 0; color: #f39c12;">
                        <i class="fas fa-star"></i> Ph·∫£n H·ªìi & ƒê√°nh Gi√°
                    </h4>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>ƒêi·ªÉm ƒë√°nh gi√° TB: 4.5/5</li>
                        <li>85% kh√°ch recommend</li>
                        <li>Ph√≤ng s·∫°ch: 4.7/5</li>
                        <li>D·ªãch v·ª•: 4.3/5</li>
                    </ul>
                </div>
            </div>
            
            <!-- Loyalty Program Analysis -->
            <h3 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                <i class="fas fa-gem"></i> Ch∆∞∆°ng Tr√¨nh Kh√°ch H√†ng Th√¢n Thi·∫øt
            </h3>
            
            <div style="background: #f8f9fa; padding: 25px; border-radius: 10px; margin-bottom: 30px;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div style="text-align: center;">
                        <div style="font-size: 2.5em; font-weight: bold; color: #f1c40f; margin-bottom: 10px;">
                            ${retentionRate}%
                        </div>
                        <div style="color: #666;">T·ª∑ l·ªá gi·ªØ ch√¢n</div>
                    </div>
                    
                    <div style="text-align: center;">
                        <div style="font-size: 2.5em; font-weight: bold; color: #27ae60; margin-bottom: 10px;">
                            ${vipCustomers}
                        </div>
                        <div style="color: #666;">Th√†nh vi√™n VIP</div>
                    </div>
                    
                    <div style="text-align: center;">
                        <div style="font-size: 2.5em; font-weight: bold; color: #9b59b6; margin-bottom: 10px;">
                            ${formatCurrency(totalSpending * 0.15)}
                        </div>
                        <div style="color: #666;">Doanh thu t·ª´ VIP</div>
                    </div>
                    
                    <div style="text-align: center;">
                        <div style="font-size: 2.5em; font-weight: bold; color: #3498db; margin-bottom: 10px;">
                            ${(avgSpending * 1.3).toLocaleString('vi-VN')}ƒë
                        </div>
                        <div style="color: #666;">Chi ti√™u TB VIP</div>
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px;">
                    <h5 style="margin: 0 0 10px 0; color: #2c3e50;">üìä Hi·ªáu Qu·∫£ Ch∆∞∆°ng Tr√¨nh VIP</h5>
                    <div style="height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden; margin-bottom: 10px;">
                        <div style="width: 75%; height: 100%; background: linear-gradient(to right, #3498db, #9b59b6);"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.9em; color: #666;">
                        <span>Kh√°ch VIP chi·∫øm ${totalCustomers > 0 ? ((vipCustomers / totalCustomers * 100).toFixed(1)) : 0}%</span>
                        <span>ƒê√≥ng g√≥p ${totalSpending > 0 ? (((segments.vip_high + segments.vip_medium) * avgSpending * 1.3 / totalSpending * 100).toFixed(1)) : 0}% doanh thu</span>
                    </div>
                </div>
            </div>
            
            <!-- Strategic Recommendations -->
            <div style="background: #e8f4fc; padding: 25px; border-radius: 10px; border-left: 4px solid #3498db;">
                <h4 style="margin: 0 0 20px 0; color: #2c3e50;">
                    <i class="fas fa-chess-queen"></i> Chi·∫øn L∆∞·ª£c Ph√°t Tri·ªÉn Kh√°ch H√†ng
                </h4>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div>
                        <h5 style="margin: 0 0 10px 0; color: #f1c40f;">
                            <i class="fas fa-crown"></i> VIP Program Enhancement
                        </h5>
                        <ul style="margin: 0; padding-left: 20px; font-size: 0.9em;">
                            <li>Tiered membership (Gold/Platinum/Diamond)</li>
                            <li>Personalized welcome amenities</li>
                            <li>Exclusive events & experiences</li>
                            <li>Dedicated relationship manager</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h5 style="margin: 0 0 10px 0; color: #27ae60;">
                            <i class="fas fa-retweet"></i> Retention Optimization
                        </h5>
                        <ul style="margin: 0; padding-left: 20px; font-size: 0.9em;">
                            <li>Birthday/anniversary specials</li>
                            <li>Loyalty point redemption</li>
                            <li>Referral program with rewards</li>
                            <li>Win-back campaigns for inactive</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h5 style="margin: 0 0 10px 0; color: #9b59b6;">
                            <i class="fas fa-chart-line"></i> Upsell & Cross-sell
                        </h5>
                        <ul style="margin: 0; padding-left: 20px; font-size: 0.9em;">
                            <li>Room upgrade offers at check-in</li>
                            <li>Dining & spa packages</li>
                            <li>Extended stay discounts</li>
                            <li>Corporate partnership programs</li>
                        </ul>
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px;">
                    <h5 style="margin: 0 0 10px 0; color: #2c3e50;">üéØ M·ª•c Ti√™u 6 Th√°ng T·ªõi</h5>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <div>
                            <div style="font-weight: bold; color: #3498db;">+15%</div>
                            <div style="font-size: 0.9em; color: #666;">Kh√°ch VIP</div>
                        </div>
                        <div>
                            <div style="font-weight: bold; color: #27ae60;">+20%</div>
                            <div style="font-size: 0.9em; color: #666;">T·ª∑ l·ªá gi·ªØ ch√¢n</div>
                        </div>
                        <div>
                            <div style="font-weight: bold; color: #9b59b6;">+25%</div>
                            <div style="font-size: 0.9em; color: #666;">Chi ti√™u TB/kh√°ch</div>
                        </div>
                        <div>
                            <div style="font-weight: bold; color: #f39c12;">-10%</div>
                            <div style="font-size: 0.9em; color: #666;">Chi ph√≠ acquisition</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Footer -->
            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e9ecef; color: #666; font-size: 0.9em;">
                <p>B√°o c√°o ƒë∆∞·ª£c t·∫°o t·ª± ƒë·ªông v√†o ${new Date().toLocaleString('vi-VN')}</p>
                <p>D·ª±a tr√™n ph√¢n t√≠ch ${totalCustomers} kh√°ch h√†ng v√† ${managementData.customerHistory.reduce((sum, c) => sum + c.visits, 0)} l∆∞·ª£t thu√™</p>
            </div>
        </div>
    `;
}

// Helper functions for reports
function formatDateRange(start, end) {
    const startDate = new Date(start).toLocaleDateString('vi-VN');
    const endDate = new Date(end).toLocaleDateString('vi-VN');
    return `${startDate} - ${endDate}`;
}

function getFilterName(filter) {
    const filters = {
        'all': 'T·∫•t C·∫£',
        'vip': 'Ch·ªâ VIP',
        'standard': 'Ch·ªâ Standard',
        'suite': 'Ch·ªâ Suite',
        'floor1-3': 'T·∫ßng 1-3',
        'floor4-7': 'T·∫ßng 4-7'
    };
    return filters[filter] || filter;
}

function getDaysBetween(start, end) {
    const startDate = new Date(start);
    const endDate = new Date(end);
    const diffTime = Math.abs(endDate - startDate);
    return Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
}

function isRoomInFilter(room, filter) {
    switch(filter) {
        case 'all': return true;
        case 'vip': return room.type === 'vip';
        case 'standard': return room.type === 'standard';
        case 'suite': return room.type === 'suite';
        case 'floor1-3': return room.floor >= 1 && room.floor <= 3;
        case 'floor4-7': return room.floor >= 4 && room.floor <= 7;
        default: return true;
    }
}

function generateFinancialTrendChart(startDate, endDate) {
    const days = getDaysBetween(startDate, endDate);
    const revenues = Array.from({length: days}, () => Math.random() * 5000000 + 10000000);
    const expenses = revenues.map(rev => rev * (0.3 + Math.random() * 0.2));
    const profits = revenues.map((rev, i) => rev - expenses[i]);
    
    const maxValue = Math.max(...revenues, ...expenses, ...profits);
    
    return `
        <div style="display: flex; height: 100%; align-items: flex-end; gap: 5px;">
            ${Array.from({length: Math.min(days, 30)}).map((_, i) => {
                const revenueHeight = (revenues[i] / maxValue) * 100;
                const expenseHeight = (expenses[i] / maxValue) * 100;
                const profitHeight = (profits[i] / maxValue) * 100;
                
                return `
                    <div style="display: flex; flex-direction: column; align-items: center; flex: 1; height: 100%; justify-content: flex-end;">
                        <div style="width: 80%; display: flex; flex-direction: column; height: 100%;">
                            <div style="height: ${revenueHeight}%; background: #3498db; border-radius: 3px 3px 0 0;"></div>
                            <div style="height: ${expenseHeight}%; background: #e74c3c; margin-top: 2px;"></div>
                            <div style="height: ${profitHeight}%; background: #27ae60; margin-top: 2px; border-radius: 0 0 3px 3px;"></div>
                        </div>
                        <div style="font-size: 0.7em; color: #666; margin-top: 5px;">${i+1}</div>
                    </div>
                `;
            }).join('')}
        </div>
        <div style="position: absolute; bottom: 40px; left: 20px; background: rgba(255,255,255,0.9); padding: 10px; border-radius: 5px; font-size: 0.8em;">
            <div><span style="display: inline-block; width: 10px; height: 10px; background: #3498db; margin-right: 5px;"></span> Doanh thu</div>
            <div><span style="display: inline-block; width: 10px; height: 10px; background: #e74c3c; margin-right: 5px;"></span> Chi ph√≠</div>
            <div><span style="display: inline-block; width: 10px; height: 10px; background: #27ae60; margin-right: 5px;"></span> L·ª£i nhu·∫≠n</div>
        </div>
    `;
}

// Other report generation functions (simplified for brevity)
function generateServiceReport(startDate, endDate, filter) {
    return `
        <div class="report-section">
            <div class="report-header">
                <h2 style="margin: 0; color: white;"><i class="fas fa-concierge-bell"></i> B√ÅO C√ÅO D·ªäCH V·ª§</h2>
                <p style="margin: 5px 0 0 0; opacity: 0.9;">${formatDateRange(startDate, endDate)} | ${getFilterName(filter)}</p>
            </div>
            <p style="text-align: center; padding: 50px; color: #666;">B√°o c√°o d·ªãch v·ª• ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn...</p>
        </div>
    `;
}

function generateStaffReport(startDate, endDate, filter) {
    return `
        <div class="report-section">
            <div class="report-header">
                <h2 style="margin: 0; color: white;"><i class="fas fa-user-tie"></i> B√ÅO C√ÅO NH√ÇN S·ª∞</h2>
                <p style="margin: 5px 0 0 0; opacity: 0.9;">${formatDateRange(startDate, endDate)} | ${getFilterName(filter)}</p>
            </div>
            <p style="text-align: center; padding: 50px; color: #666;">B√°o c√°o nh√¢n s·ª± ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn...</p>
        </div>
    `;
}

function generateInventoryReport(startDate, endDate, filter) {
    return `
        <div class="report-section">
            <div class="report-header">
                <h2 style="margin: 0; color: white;"><i class="fas fa-boxes"></i> B√ÅO C√ÅO T·ªíN KHO</h2>
                <p style="margin: 5px 0 0 0; opacity: 0.9;">${formatDateRange(startDate, endDate)} | ${getFilterName(filter)}</p>
            </div>
            <p style="text-align: center; padding: 50px; color: #666;">B√°o c√°o t·ªìn kho ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn...</p>
        </div>
    `;
}

// Report management functions
function loadReportTemplate(templateId) {
    const template = reportTemplates[templateId];
    if (template) {
        document.getElementById('reportTypeSelect').value = template.type === 'daily' ? 'financial' : 
                                                          template.type === 'monthly' ? 'financial' : 
                                                          template.type === 'analysis' ? 'customer' : 
                                                          template.type === 'performance' ? 'occupancy' : 'financial';
        
        document.getElementById('reportPeriodSelect').value = template.type === 'daily' ? 'daily' : 
                                                             template.type === 'monthly' ? 'monthly' : 'monthly';
        
        addNotification(`ƒê√£ t·∫£i m·∫´u "${template.name}"`, 'success');
    }
}

function exportReportToExcel() {
    addNotification('ƒêang xu·∫•t b√°o c√°o sang Excel...', 'info');
    // In a real implementation, this would generate an Excel file
    setTimeout(() => {
        addNotification('Xu·∫•t Excel th√†nh c√¥ng!', 'success');
    }, 1500);
}

function printReport() {
    const reportArea = document.getElementById('reportDisplayArea');
    if (reportArea.style.display !== 'none') {
        const printWindow = window.open('', '_blank');
        printWindow.document.write(`
            <html>
                <head>
                    <title>In B√°o C√°o</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .report-header { background: #2c3e50; color: white; padding: 20px; margin-bottom: 20px; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        th, td { padding: 10px; border: 1px solid #ddd; }
                        th { background: #f8f9fa; }
                        @media print {
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    ${reportArea.innerHTML}
                    <div class="no-print" style="text-align: center; margin-top: 30px;">
                        <button onclick="window.print()" style="padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            In B√°o C√°o
                        </button>
                        <button onclick="window.close()" style="padding: 10px 20px; background: #666; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
                            ƒê√≥ng
                        </button>
                    </div>
                </body>
            </html>
        `);
        printWindow.document.close();
    } else {
        addNotification('Vui l√≤ng t·∫°o b√°o c√°o tr∆∞·ªõc khi in', 'warning');
    }
}

function saveReportTemplate() {
    const reportType = document.getElementById('reportTypeSelect').value;
    const reportPeriod = document.getElementById('reportPeriodSelect').value;
    const filter = document.getElementById('reportFilterSelect').value;
    
    const templateName = prompt('Nh·∫≠p t√™n cho m·∫´u b√°o c√°o:', 
        `M·∫´u ${reportType} ${reportPeriod} ${filter}`);
    
    if (templateName) {
        const newTemplate = {
            id: 'custom_' + Date.now(),
            name: templateName,
            type: reportType,
            period: reportPeriod,
            filter: filter,
            created: new Date().toISOString()
        };
        
        // In a real implementation, save to localStorage or server
        addNotification(`ƒê√£ l∆∞u m·∫´u "${templateName}"`, 'success');
    }
}

function updateSavedReportsList() {
    const list = document.getElementById('savedReportsList');
    
    if (savedReports.length === 0) {
        list.innerHTML = `
            <tr>
                <td colspan="6" style="text-align: center; padding: 40px; color: #666;">
                    <i class="fas fa-folder-open" style="font-size: 2em; margin-bottom: 10px; display: block;"></i>
                    Ch∆∞a c√≥ b√°o c√°o n√†o ƒë∆∞·ª£c l∆∞u
                </td>
            </tr>
        `;
        return;
    }
    
    list.innerHTML = savedReports.map(report => `
        <tr>
            <td><strong>${report.name}</strong></td>
            <td><span class="status-badge status-active">${report.type}</span></td>
            <td>${report.period}</td>
            <td>${new Date(report.created).toLocaleDateString('vi-VN')}</td>
            <td>${(Math.random() * 2 + 0.5).toFixed(1)} MB</td>
            <td>
                <button class="modal-btn confirm" style="padding: 5px 10px; font-size: 0.8em; margin-right: 5px;" onclick="loadSavedReport('${report.id}')">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="modal-btn confirm" style="padding: 5px 10px; font-size: 0.8em; margin-right: 5px; background: #27ae60;">
                    <i class="fas fa-download"></i>
                </button>
                <button class="modal-btn cancel" style="padding: 5px 10px; font-size: 0.8em;">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        </tr>
    `).join('');
}

function saveReportToHistory(type, period, date) {
    const report = {
        id: 'report_' + Date.now(),
        name: `B√°o c√°o ${type} ${period} ${date.toLocaleDateString('vi-VN')}`,
        type: type,
        period: period,
        created: date.toISOString(),
        size: (Math.random() * 2 + 0.5).toFixed(1)
    };
    
    savedReports.unshift(report);
    if (savedReports.length > 20) savedReports.pop(); // Keep only last 20
    
    localStorage.setItem('hotel_saved_reports', JSON.stringify(savedReports));
    updateSavedReportsList();
}

// Initialize report management when page loads
window.addEventListener('load', function() {
    initializeReportManagement();
});
    </script>
</body>
</html>
